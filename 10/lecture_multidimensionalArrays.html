<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.7.31">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>Multi-dimensional arrays â€“ Introduction to Coding and Data Analysis</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
html { -webkit-text-size-adjust: 100%; }
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<script src="../site_libs/quarto-html/quarto.js" type="module"></script>
<script src="../site_libs/quarto-html/tabsets/tabsets.js" type="module"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-4a990d8dcb58f517c7c86712b8f2ac7c.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-748393fd2cb2ea724105813453792ea0.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script src="../site_libs/quarto-contrib/live-runtime/live-runtime.js" type="module"></script>
<link href="../site_libs/quarto-contrib/live-runtime/live-runtime.css" rel="stylesheet">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="../site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="../site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">
<meta name="robots" content="noindex, nofollow">

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../styles.css">
</head>

<body class="nav-sidebar docked nav-fixed quarto-light">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../index.html">
    <span class="navbar-title">Intro to Coding &amp; Data Analysis</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link active" href="../index.html" aria-current="page"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-lessons" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Lessons</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-lessons">    
        <li>
    <a class="dropdown-item" href="../01/week_01_home.html">
 <span class="dropdown-text">01 - Introduction to Data Types</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../07/lecture_intro_numpy.html">
 <span class="dropdown-text">07 - Introduction to NumPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/lecture_working_with_numpy.html">
 <span class="dropdown-text">08 - Working with NumPy</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/lecture_intro_matplotlib.html">
 <span class="dropdown-text">09 - Introduction to Matplotlib</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/lecture_multidimensionalArrays.html">
 <span class="dropdown-text">10 - Multidimensional Arrays</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/lecture_beyond_the_notebook.html">
 <span class="dropdown-text">11 - Beyond the Notebook</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-exercises" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Exercises</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-exercises">    
        <li>
    <a class="dropdown-item" href="../01/week_01_intro_to_data_types_beginner.html">
 <span class="dropdown-text">01 - Intro to Data Types Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01/week_01_intro_to_data_types_intermediate.html">
 <span class="dropdown-text">01 - Intro to Data Types Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../01/week_01_intro_to_data_types_advanced.html">
 <span class="dropdown-text">01 - Intro to Data Types Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../07/exercises_numpy.html">
 <span class="dropdown-text">07 - NumPy Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/exercises_lecture_working_with_numpy.html">
 <span class="dropdown-text">08 - NumPy Working Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/exercises_plotting_data_from_file.html">
 <span class="dropdown-text">09 - Plotting Data Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part1.html">
 <span class="dropdown-text">10 - Part 1 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part2.html">
 <span class="dropdown-text">10 - Part 2 Exercises</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_numpy_riddles.html">
 <span class="dropdown-text">11 - NumPy Riddles</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_python_riddles.html">
 <span class="dropdown-text">11 - Python Riddles</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-solutions" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Solutions</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-solutions">    
        <li>
    <a class="dropdown-item" href="../07/exercises_numpy_solutions.html">
 <span class="dropdown-text">07 - NumPy Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../08/exercises_lecture_working_with_numpy_solutions.html">
 <span class="dropdown-text">08 - NumPy Working Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../09/exercises_plotting_data_from_file_solutions.html">
 <span class="dropdown-text">09 - Plotting Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part1_solutions.html">
 <span class="dropdown-text">10 - Part 1 Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../10/exercises_part2_solutions.html">
 <span class="dropdown-text">10 - Part 2 Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_numpy_riddles_solutions.html">
 <span class="dropdown-text">11 - NumPy Riddles Solutions</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../11/exercises_python_riddles_solutions.html">
 <span class="dropdown-text">11 - Python Riddles Solutions</span></a>
  </li>  
    </ul>
  </li>
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-formative-tests" role="link" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Formative tests</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-formative-tests">    
        <li>
    <a class="dropdown-item" href="../formative/basic_structures.html">
 <span class="dropdown-text">Variables, lists, dictionaries and branches</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../10/lecture_multidimensionalArrays.html">10 Multidimensional Arrays</a></li><li class="breadcrumb-item"><a href="../10/lecture_multidimensionalArrays.html">Multi-dimensional arrays</a></li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation docked overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
      <a href="../index.html" class="sidebar-logo-link">
      <img src="../figs/banner.png" alt="" class="sidebar-logo py-0 d-lg-inline d-none">
      </a>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false">
 <span class="menu-text">Course Overview</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Introduction to Coding and Data Analysis</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false">
 <span class="menu-text">01 Introduction to Data Types</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_home.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Week 1: Introduction to Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_beginner.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beginner: Basic Data Types</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_intermediate.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Intermediate: Collections</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../01/week_01_intro_to_data_types_advanced.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Advanced: Copying and References</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false">
 <span class="menu-text">07 Introduction to NumPy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-3" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-3" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07/lecture_intro_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">The <code>numpy</code> module</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07/exercises_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><code>numpy</code> Exercises</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../07/exercises_numpy_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false">
 <span class="menu-text">08 Working with NumPy</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-4" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-4" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08/lecture_working_with_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Working with Arrays in NumPy: Indexing and Random Data Generation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08/exercises_lecture_working_with_numpy.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Exercises - Working with NumPy</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../08/exercises_lecture_working_with_numpy_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false">
 <span class="menu-text">09 Introduction to Matplotlib</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-5" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-5" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/lecture_intro_matplotlib.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting with <code>matplotlib</code></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/exercises_plotting_data_from_file.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Plotting data from file</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/exercises_plotting_data_from_file_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../09/fun_matplotlib_decoration.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Add some decoration</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true">
 <span class="menu-text">10 Multidimensional Arrays</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-6" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-6" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/lecture_multidimensionalArrays.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text">Multi-dimensional arrays</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part1.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Creating a mask containing a circle</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part1_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions - Part 1</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part2.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Using a mask</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/exercises_part2_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions - Part 2</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/hint1_mask.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hint 1 - creating a square mask</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../10/hint2_apply_mask.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Hint 2 - applying a rectangular mask</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false">
 <span class="menu-text">11 Beyond the Notebook</span></a>
          <a class="sidebar-item-toggle text-start collapsed" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-7" role="navigation" aria-expanded="false" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-7" class="collapse list-unstyled sidebar-section depth1 ">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/lecture_beyond_the_notebook.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Beyond the notebook</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/exercises_numpy_riddles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidation - <code>numpy</code> riddles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/exercises_numpy_riddles_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions - NumPy Riddles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/exercises_python_riddles.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Consolidation - <code>Python</code> riddles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/exercises_python_riddles_solutions.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Solutions - Python Riddles</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../11/example.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">example.html</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#basic-properties-of-multi-dimensional-arrays" id="toc-basic-properties-of-multi-dimensional-arrays" class="nav-link active" data-scroll-target="#basic-properties-of-multi-dimensional-arrays">Basic properties of multi-dimensional arrays</a>
  <ul class="collapse">
  <li><a href="#shape" id="toc-shape" class="nav-link" data-scroll-target="#shape">Shape</a></li>
  <li><a href="#axis-and-rank" id="toc-axis-and-rank" class="nav-link" data-scroll-target="#axis-and-rank">Axis and Rank</a></li>
  <li><a href="#slicing" id="toc-slicing" class="nav-link" data-scroll-target="#slicing">Slicing</a></li>
  <li><a href="#reshaping-and-flattening" id="toc-reshaping-and-flattening" class="nav-link" data-scroll-target="#reshaping-and-flattening">Reshaping and flattening</a></li>
  <li><a href="#broadcasting" id="toc-broadcasting" class="nav-link" data-scroll-target="#broadcasting">Broadcasting</a></li>
  </ul></li>
  <li><a href="#two-dimensional-arrays-as-matrices-some-linear-algebra" id="toc-two-dimensional-arrays-as-matrices-some-linear-algebra" class="nav-link" data-scroll-target="#two-dimensional-arrays-as-matrices-some-linear-algebra">Two-dimensional arrays as matrices: some linear algebra</a></li>
  <li><a href="#matrices-as-images" id="toc-matrices-as-images" class="nav-link" data-scroll-target="#matrices-as-images">Matrices as images</a></li>
  <li><a href="#pair-programming" id="toc-pair-programming" class="nav-link" data-scroll-target="#pair-programming">Pair programming</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../10/lecture_multidimensionalArrays.html">10 Multidimensional Arrays</a></li><li class="breadcrumb-item"><a href="../10/lecture_multidimensionalArrays.html">Multi-dimensional arrays</a></li></ol></nav>
<div class="quarto-title">
<div class="quarto-title-block"><div><h1 class="title">Multi-dimensional arrays</h1><button type="button" class="btn code-tools-button" id="quarto-code-tools-source"><i class="bi"></i> Code</button></div></div>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p>A <code>numpy.ndarray</code> is the more complete term for a <code>numpy</code> <code>array</code> object. Up until this point we have mainly been dealing with and using one dimensional arrays. Numpy arrays (unlike lists) have the concept of shape whicih means they can be multi-dimensional. This means they can represent a grid (2D), a cuboid (3D) and so forth.</p>
<p>The code below generates a <code>numpy.array</code> object containing random numbers. This is a 2D array with a 3 x 3 shape:</p>
<div id="d13ac5f1" class="cell" data-execution_count="2">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> random</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> random.default_rng(seed<span class="op">=</span><span class="dv">24</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="6175dd38" class="cell" data-execution_count="3">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a>array1 <span class="op">=</span> rng.random(shape)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1.shape)</span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>(3, 3)
[[0.33026884 0.40517732 0.57473782]
 [0.50639977 0.56421251 0.56968731]
 [0.87411653 0.08643046 0.74247527]]</code></pre>
</div>
</div>
<p>We can select one element from this array using the following syntax. We still use square brackets and pass an index value but now we can pass values for each dimension seperated by a comma (<code>,</code>). This index is selecting the third column within the second row:</p>
<div id="6f7604f0" class="cell" data-execution_count="4">
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">1</span>, <span class="dv">2</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>0.5696873105084019</code></pre>
</div>
</div>
<p>Using slicing (<em>Start:Stop</em>) syntax you can select an entire dimension at once by omitting both the Start and Stop values and just using <code>:</code>. You can see how this works if you try the slice with just the Start or just the Stop e.g.</p>
<div id="86da96e6" class="cell" data-execution_count="5">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[:<span class="dv">2</span>])</span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">2</span>:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[0.33026884 0.40517732 0.57473782]
 [0.50639977 0.56421251 0.56968731]]
[[0.87411653 0.08643046 0.74247527]]</code></pre>
</div>
</div>
<p>Not including a Start index includes values from the beginning of the array/list etc. up to (but not including) the Stop.</p>
<p>Not including a Stop index reads from the Start to the end of the array/list etc.</p>
<p>So just using <code>:</code> with no Start or Stop selects all elements for that dimension.</p>
<p>This following syntax returns first row (first row, every column):</p>
<div id="0ad205a7" class="cell" data-execution_count="6">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">0</span>,:])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.33026884 0.40517732 0.57473782]</code></pre>
</div>
</div>
<p>And this would return the first column (every row, first column):</p>
<div id="40fc9c44" class="cell" data-execution_count="7">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[:,<span class="dv">0</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[0.33026884 0.50639977 0.87411653]</code></pre>
</div>
</div>
<p><code>numpy</code> <code>array</code> objects store data in <strong>row-major</strong> order. Essentially this means for a 2D index this would be the equivalent of [y, x] rather than [x, y].</p>
<section id="basic-properties-of-multi-dimensional-arrays" class="level2">
<h2 class="anchored" data-anchor-id="basic-properties-of-multi-dimensional-arrays">Basic properties of multi-dimensional arrays</h2>
<section id="shape" class="level3">
<h3 class="anchored" data-anchor-id="shape">Shape</h3>
<p>The <strong>shape</strong> of a multi-dimensional array is a tuple that describes the size of each dimension. For example, a 2D array with 3 rows and 4 columns has a shape of <code>(3, 4)</code>. You can access the shape of an array using the <code>.shape</code> attribute.</p>
<p>We can use many of the array initialisation functions we haver seen for 1d arrays also to create multi-dimensional arrays. For example, we can use <code>np.zeros</code> to create a 2D array of zeros, or <code>np.ones</code> to create a 2D array of ones. We can also use <code>np.random.rand</code> to create a 2D array of random numbers.</p>
<div id="77b5c097" class="cell" data-execution_count="8">
<div class="sourceCode cell-code" id="cb12"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>array_of_zeros <span class="op">=</span> np.zeros(shape<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">3</span>)) <span class="co"># 2 rows, 3 columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<div id="da9feee4" class="cell" data-execution_count="9">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>np.ones_like(array_of_zeros)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="8">
<pre><code>array([[1., 1., 1.],
       [1., 1., 1.]])</code></pre>
</div>
</div>
</section>
<section id="axis-and-rank" class="level3">
<h3 class="anchored" data-anchor-id="axis-and-rank">Axis and Rank</h3>
<p>A multi-dimensional array has multiple dimensions, each of which can be thought of as an <strong>axis</strong>. The number of dimensions is called the <strong>rank</strong> of the array. For example, a 2D array has a rank of 2, while a 3D array has a rank of 3. It is accessible via the <code>.ndim</code> attribute.</p>
<p>We typically call a rank 2 array a <strong>matrix</strong>. A rank 3 array (or higher) is often called a <strong>tensor</strong>.</p>
<div id="c0c3276a" class="cell" data-execution_count="10">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> random.default_rng(seed<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a>random_matrix <span class="op">=</span> rng.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">5</span>)) <span class="co"># random floats between -1 and 1, 2 rows, 5 columns</span></span>
<span id="cb15-3"><a href="#cb15-3" aria-hidden="true" tabindex="-1"></a>random_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="9">
<pre><code>array([[-0.33946233, -0.18964537,  0.14947564,  0.01279953,  0.12842501],
       [ 0.13937462,  0.74823306, -0.82713908,  0.48495054,  0.64073453]])</code></pre>
</div>
</div>
<div id="becd812e" class="cell" data-execution_count="11">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>random_matrix.ndim <span class="co"># two dimensions, rank 2, a matrix</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="10">
<pre><code>2</code></pre>
</div>
</div>
<div id="a20ef71a" class="cell" data-execution_count="12">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>random_tensor <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">3</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="co"># random integes in [0,3), 2x3x4 tensor</span></span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>random_tensor</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="11">
<pre><code>array([[[0, 2, 1, 1],
        [2, 2, 0, 0],
        [1, 2, 0, 1]],

       [[2, 0, 1, 0],
        [0, 1, 1, 0],
        [0, 1, 0, 1]]])</code></pre>
</div>
</div>
<div id="e5bba87c" class="cell" data-execution_count="13">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>random_tensor.ndim</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="12">
<pre><code>3</code></pre>
</div>
</div>
<p>We can perform operations along specific axes of a multi-dimensional array. For example, we can sum all the elements along a specific axis using the <code>np.sum</code> function with the <code>axis</code> parameter.</p>
<div id="df43c272" class="cell" data-execution_count="14">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>small_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">2</span>,size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">2</span>)) </span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>small_matrix</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="13">
<pre><code>array([[1, 1],
       [1, 0],
       [1, 0]])</code></pre>
</div>
</div>
<div id="1638a90f" class="cell" data-execution_count="15">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>small_matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># sum along the first axis (rows)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="14">
<pre><code>array([3, 1])</code></pre>
</div>
</div>
<div id="d21cc641" class="cell" data-execution_count="16">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>small_matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># sum along the second axis (columns), can you explain the resulting shape?</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="15">
<pre><code>array([2, 1, 1])</code></pre>
</div>
</div>
<p>One can do the same also with useful statistical descriptors such as <code>np.mean</code>, <code>np.std</code>, etc.</p>
<div id="b4d9f9a8" class="cell" data-execution_count="17">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>np.mean(small_matrix, axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># mean along the first axis (rows)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="16">
<pre><code>array([1.        , 0.33333333])</code></pre>
</div>
</div>
</section>
<section id="slicing" class="level3">
<h3 class="anchored" data-anchor-id="slicing">Slicing</h3>
<p>Slicing works similarly to 1D arrays, but you can slice along multiple axes. For example, you can slice a 2D array to get a submatrix or a specific row or column.</p>
<div id="e21cfe43" class="cell" data-execution_count="18">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>small_matrix[:, <span class="dv">0</span>] <span class="co"># all rows, first column</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="17">
<pre><code>array([1, 1, 1])</code></pre>
</div>
</div>
<div id="911637f4" class="cell" data-execution_count="19">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>small_matrix[:<span class="dv">2</span>,:] <span class="co"># first two rows, all columns</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="18">
<pre><code>array([[1, 1],
       [1, 0]])</code></pre>
</div>
</div>
<div id="55090551" class="cell" data-execution_count="20">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="19">
<pre><code>array([[1],
       [1],
       [1]])</code></pre>
</div>
</div>
</section>
<section id="reshaping-and-flattening" class="level3">
<h3 class="anchored" data-anchor-id="reshaping-and-flattening">Reshaping and flattening</h3>
<p>The last example show an inetresting case: we extracted a single column from the matrix, but it is still a 2D array with shape <code>(3, 1)</code>.</p>
<div id="1cbc7b26" class="cell" data-execution_count="21">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape"</span>, selection.shape)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"rank"</span>, selection.ndim)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>shape (3, 1)
rank 2</code></pre>
</div>
</div>
<p>What if we wanted a truly 1d array (rank 1)? We need to <strong>reshape</strong> the array.</p>
<p>We can use the <code>np.reshape</code> function to change the shape of an array without changing its data. For example, we can reshape a 2D array into a 1D array or vice versa.</p>
<p>Reshape takes a tuple of the new shape as an argument. If you want to flatten an array (convert it to a 1D array), you can use <code>-1</code> as one of the dimensions, which tells NumPy to infer the size of that dimension based on the total number of elements.</p>
<div id="61e0a6e9" class="cell" data-execution_count="22">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>reshaped_selection <span class="op">=</span> selection.reshape((<span class="dv">3</span>,))  <span class="co"># reshape to a 1D array excplicitly</span></span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped shape"</span>, reshaped_selection.shape)</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped rank"</span>, reshaped_selection.ndim)</span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped selection"</span>, reshaped_selection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>reshaped shape (3,)
reshaped rank 1
reshaped selection [1 1 1]</code></pre>
</div>
</div>
<div id="110b50db" class="cell" data-execution_count="23">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="co">#same code as above, but with inferred shape</span></span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>reshaped_selection <span class="op">=</span> selection.reshape(<span class="op">-</span><span class="dv">1</span>)  <span class="co"># infererd shape</span></span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped shape"</span>, reshaped_selection.shape)</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped rank"</span>, reshaped_selection.ndim)</span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped selection"</span>, reshaped_selection)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>reshaped shape (3,)
reshaped rank 1
reshaped selection [1 1 1]</code></pre>
</div>
</div>
<p>Another way to cast a multi-dimensional array to a 1D array is to use the <code>np.ravel()</code> function, which returns a flattened view of the array (not a copy).</p>
<div id="88eeeb8c" class="cell" data-execution_count="24">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>a_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># random integers in [0,10), 2x3 matrix</span></span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original matrix:</span><span class="ch">\n</span><span class="st">"</span>, a_matrix)</span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>ravelled_view <span class="op">=</span> a_matrix.ravel()</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened view:"</span>, ravelled_view)  <span class="co"># flatten the array to a 1D array</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Original matrix:
 [[4 7 8]
 [7 7 0]]
Flattened view: [4 7 8 7 7 0]</code></pre>
</div>
</div>
<p>If we modify the view, we modify the original array as well.</p>
<div id="d60027af" class="cell" data-execution_count="25">
<div class="sourceCode cell-code" id="cb45"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>ravelled_view[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># modify the view</span></span>
<span id="cb45-2"><a href="#cb45-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modified view:"</span>, ravelled_view)  <span class="co"># the view is modified</span></span>
<span id="cb45-3"><a href="#cb45-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original array:"</span>, a_matrix)  <span class="co"># the original array is modified as well</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Modified view: [100   7   8   7   7   0]
Original array: [[100   7   8]
 [  7   7   0]]</code></pre>
</div>
</div>
<p>To obtain a completely independent flattened copy of the array, you can use the <code>np.flatten()</code> method, which returns a copy of the array in a 1D format.</p>
<div id="184c5176" class="cell" data-execution_count="26">
<div class="sourceCode cell-code" id="cb47"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>a_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># random integers in [0,10), 2x3 matrix</span></span>
<span id="cb47-2"><a href="#cb47-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The original:</span><span class="ch">\n</span><span class="st">"</span>,a_matrix)</span>
<span id="cb47-3"><a href="#cb47-3" aria-hidden="true" tabindex="-1"></a>flattened_copy <span class="op">=</span> a_matrix.flatten()</span>
<span id="cb47-4"><a href="#cb47-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened:"</span>,flattened_copy)  <span class="co"># flatten the array to a 1D array</span></span>
<span id="cb47-5"><a href="#cb47-5" aria-hidden="true" tabindex="-1"></a>flattened_copy[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># modify the copy</span></span>
<span id="cb47-6"><a href="#cb47-6" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened after modification:"</span>,flattened_copy)  <span class="co"># the copy is modified</span></span>
<span id="cb47-7"><a href="#cb47-7" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The original:</span><span class="ch">\n</span><span class="st">"</span>,a_matrix)  <span class="co"># the original array is not modified</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>The original:
 [[4 4 7]
 [4 6 9]]
Flattened: [4 4 7 4 6 9]
Flattened after modification: [100   4   7   4   6   9]
The original:
 [[4 4 7]
 [4 6 9]]</code></pre>
</div>
</div>
<p>We can also do the opposite and increase the rank of an array by reshaping it. For example, we can reshape a 1D array into a 2D array with one column or one row.</p>
<div id="60740977" class="cell" data-execution_count="27">
<div class="sourceCode cell-code" id="cb49"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>one_dimensional_array <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">5</span>,))  <span class="co"># random integers in [0,10), 1D array</span></span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"One-dimensional array:"</span>, one_dimensional_array)</span>
<span id="cb49-3"><a href="#cb49-3" aria-hidden="true" tabindex="-1"></a>reshaped_array <span class="op">=</span> one_dimensional_array.reshape((<span class="dv">5</span>,<span class="dv">1</span>))  <span class="co"># reshape to a  2D array with one column</span></span>
<span id="cb49-4"><a href="#cb49-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reshaped array:</span><span class="ch">\n</span><span class="st">"</span>, reshaped_array)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One-dimensional array: [5 5 5 3 2]
Reshaped array:
 [[5]
 [5]
 [5]
 [3]
 [2]]</code></pre>
</div>
</div>
</section>
<section id="broadcasting" class="level3">
<h3 class="anchored" data-anchor-id="broadcasting">Broadcasting</h3>
<p>Combining arrays of different shapes is possible in NumPy using a feature called <strong>broadcasting</strong>. Broadcasting allows NumPy to perform operations on arrays of different shapes by automatically expanding the smaller array to match the shape of the larger one.</p>
<div id="32bffd05" class="cell" data-execution_count="28">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal broadcasting example: rank 2 (matrix) with rank 1 (vector)</span></span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>])</span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb51-6"><a href="#cb51-6" aria-hidden="true" tabindex="-1"></a><span class="co"># Broadcasting addition: vector is added to each row of the matrix</span></span>
<span id="cb51-7"><a href="#cb51-7" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> matrix <span class="op">+</span> vector</span>
<span id="cb51-8"><a href="#cb51-8" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix:</span><span class="ch">\n</span><span class="st">"</span>, matrix)</span>
<span id="cb51-9"><a href="#cb51-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vector:"</span>, vector)</span>
<span id="cb51-10"><a href="#cb51-10" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Result of broadcasting:</span><span class="ch">\n</span><span class="st">"</span>, result)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix:
 [[1 2 3]
 [4 5 6]]
Vector: [10 20 30]
Result of broadcasting:
 [[11 22 33]
 [14 25 36]]</code></pre>
</div>
</div>
<p>You can reshape a 1D array to a column or row vector and use broadcasting to expand it into a large table. For example, to create a table where each row is the original 1D array, or each column is the original array:</p>
<div id="cea8ff42" class="cell" data-execution_count="29">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>one_dimensional_array <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">5</span>, num<span class="op">=</span><span class="dv">5</span>)  <span class="co"># create a 1D array with 5 elements</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"One-dimensional array:"</span>, one_dimensional_array)</span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a><span class="co"># Expand one_dimensional_array to a table with 5 rows and 5 columns</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>row_vector <span class="op">=</span> one_dimensional_array.reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)  <span class="co"># shape (1, 5)</span></span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>column_vector <span class="op">=</span> one_dimensional_array.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># shape (5, 1)</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Broadcasting to create a table</span></span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> column_vector <span class="op">+</span> row_vector</span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BroadcastedTable:</span><span class="ch">\n</span><span class="st">"</span>,table)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>One-dimensional array: [1. 2. 3. 4. 5.]
BroadcastedTable:
 [[ 2.  3.  4.  5.  6.]
 [ 3.  4.  5.  6.  7.]
 [ 4.  5.  6.  7.  8.]
 [ 5.  6.  7.  8.  9.]
 [ 6.  7.  8.  9. 10.]]</code></pre>
</div>
</div>
</section>
</section>
<section id="two-dimensional-arrays-as-matrices-some-linear-algebra" class="level2">
<h2 class="anchored" data-anchor-id="two-dimensional-arrays-as-matrices-some-linear-algebra">Two-dimensional arrays as matrices: some linear algebra</h2>
<p>Two-dimensional arrays are often used to represent matrices or images. In a matrix, each element can be accessed using two indices: - one for the row - one for the column.</p>
<p>A matrix is a rectangular array of numbers, symbols, or expressions arranged in rows and columns and is an essential concept in <strong>linear algebra</strong>.</p>
<p>For examplle, letâ€™s consider the simple system of simultaneous equations:</p>
<p><span class="math display">\[ \begin{align*}
2x + 3y +z &amp;= 5 \\
4x - y &amp;= 1 \\
2y +z &amp;= 3
\end{align*} \]</span></p>
<p>This can be represented in matrix form as: <span class="math display">\[ \begin{bmatrix}
2 &amp; 3 &amp;1  \\
4 &amp; -1 &amp;0 \\
0 &amp; 2 &amp;1
\end{bmatrix}
\begin{bmatrix}
x \\
y \\
z
\end{bmatrix}
=
\begin{bmatrix}5 \\
1\\
3
\end{bmatrix} \]</span></p>
<p>And if we call <span class="math inline">\(A\)</span> the matrix of coefficients, <span class="math inline">\(\mathbf{x}\)</span> the vector of variables, and <span class="math inline">\(b\)</span> the vector of constants, we can write this as: <span class="math display">\[ A \mathbf{x} = \mathbf{b} \]</span></p>
<p>where <span class="math display">\[A = \begin{bmatrix}
2 &amp; 3 &amp;1  \\
4 &amp; -1 &amp;0 \\
0 &amp; 2 &amp;1
\end{bmatrix}, \quad
\mathbf{x} = \begin{bmatrix}
x \\
y\\
z
\end{bmatrix}, \quad
\mathbf{b} = \begin{bmatrix}
5 \\
1\\
3
\end{bmatrix} \]</span></p>
<p>A key result of linear algebra is that if <span class="math inline">\(A\)</span> is invertible, we can solve for <span class="math inline">\(\mathbf{x}\)</span> by multiplying both sides of the equation by the inverse of <span class="math inline">\(A\)</span>: <span class="math display">\[ \mathbf{x} = A^{-1} \mathbf{b} \]</span></p>
<p>where <span class="math inline">\(A^{-1}\)</span> is the inverse of matrix <span class="math inline">\(A\)</span>.</p>
<p>NumPy has a dedicated linear algebra submodule called <code>numpy.linalg</code> that provides functions for performing various linear algebra operations, including matrix inversion, solving systems of equations, and computing eigenvalues and eigenvectors.</p>
<div id="fd87dc92" class="cell" data-execution_count="30">
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">1</span>], [<span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>]])</span>
<span id="cb55-2"><a href="#cb55-2" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([[<span class="dv">5</span>], [<span class="dv">1</span>], [<span class="dv">3</span>]]) <span class="co"># we use double brackets to create a column vector</span></span>
<span id="cb55-3"><a href="#cb55-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix A:</span><span class="ch">\n</span><span class="st">"</span>, A)</span>
<span id="cb55-4"><a href="#cb55-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vector b:</span><span class="ch">\n</span><span class="st">"</span>, b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Matrix A:
 [[ 2  3  1]
 [ 4 -1  0]
 [ 0  2  1]]
Vector b:
 [[5]
 [1]
 [3]]</code></pre>
</div>
</div>
<p>The linear algebra submodule has a function called <code>solve</code> which can be used to solve the above equation efficiently:</p>
<div id="69427cf2" class="cell" data-execution_count="31">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="30">
<pre><code>array([[0.5],
       [1. ],
       [1. ]])</code></pre>
</div>
</div>
<p>But we can use numpy to verify that this is correct. We can use the symbol <code>@</code> to perform matrix multiplication in numpy.</p>
<div id="51b4bcbe" class="cell" data-execution_count="32">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>A <span class="op">@</span> x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="31">
<pre><code>array([[5.],
       [1.],
       [3.]])</code></pre>
</div>
</div>
<p>We can also directly calculate the inverse of a matrix using the <code>inv</code> function from the <code>numpy.linalg</code> and use it to solve the equation</p>
<div id="c36fdda6" class="cell" data-execution_count="33">
<div class="sourceCode cell-code" id="cb61"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.inv(A) <span class="op">@</span> b</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>x</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="32">
<pre><code>array([[0.5],
       [1. ],
       [1. ]])</code></pre>
</div>
</div>
<p>All the most common linear algebra operations are available in the <code>numpy.linalg</code> submodule:</p>
<ul>
<li>tranpose</li>
</ul>
<div id="87c58a63" class="cell" data-execution_count="34">
<div class="sourceCode cell-code" id="cb63"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>b.T</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="33">
<pre><code>array([[5, 1, 3]])</code></pre>
</div>
</div>
<ul>
<li>scalar (dot) product (which takes two vectors and returns a scalar)</li>
</ul>
<div id="fc2c776d" class="cell" data-execution_count="35">
<div class="sourceCode cell-code" id="cb65"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>np.dot(b.T,b)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="34">
<pre><code>array([[35]])</code></pre>
</div>
</div>
<ul>
<li>cross product</li>
</ul>
<div id="24d727f6" class="cell" data-execution_count="36">
<div class="sourceCode cell-code" id="cb67"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>np.cross(b.T, b.T) <span class="co">#takes row vectors and returns a row vector</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="35">
<pre><code>array([[0, 0, 0]])</code></pre>
</div>
</div>
<p>Linear algebra applications are beyond the scope of this course (so, there will be <strong>no assessment of these</strong>), but they are widely used in various fields such as physics, computer science, and engineering. For example, they are essential in computer graphics for transformations, in machine learning for optimization, and in physics for solving systems of equations. So it is important for you to know that all these can be implemented efficiently using numpy.</p>
</section>
<section id="matrices-as-images" class="level2">
<h2 class="anchored" data-anchor-id="matrices-as-images">Matrices as images</h2>
<p>A two-dimensional table of numbers can also be used to represent an image. Each number in the table corresponds to a pixel in the image, and the value of the number represents the color or intensity of that pixel.</p>
<p><code>matplotlib</code> provides a convenient way to visualize 2D arrays as images. The <code>matshow</code> function can be used to display a 2D matrix as an image, where the values in the array are mapped to colors.</p>
<div id="7efce5f1" class="cell" data-execution_count="37">
<div class="sourceCode cell-code" id="cb69"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>plt.matshow(A)</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[[ 2  3  1]
 [ 4 -1  0]
 [ 0  2  1]]</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-37-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Notice that the indices of the y-axis increase as we go down. These are the indices of the rows in the matrix.</p>
<p>For a matrix of a given shape we can get the indices using the <code>np.indices</code> function, which returns a grid of indices for each dimension. This can be useful for creating masks or selecting specific regions of the matrix.</p>
<div id="acb9d9ac" class="cell" data-execution_count="38">
<div class="sourceCode cell-code" id="cb71"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>row_index, col_index <span class="op">=</span> np.indices(A.shape)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Row indices:</span><span class="ch">\n</span><span class="st">"</span>, row_index)</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Column indices:</span><span class="ch">\n</span><span class="st">"</span>, col_index)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>Row indices:
 [[0 0 0]
 [1 1 1]
 [2 2 2]]
Column indices:
 [[0 1 2]
 [0 1 2]
 [0 1 2]]</code></pre>
</div>
</div>
<p>An alternative function is <code>imshow</code>, which is more general and can be used for both 2D arrays and images.</p>
<p>Here we can set the origin of the axis:</p>
<div id="c0143148" class="cell" data-execution_count="39">
<div class="sourceCode cell-code" id="cb73"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(A, origin<span class="op">=</span><span class="st">'lower'</span>)  <span class="co"># origin='lower' to set the origin at the bottom left</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-39-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="f8bb0d2b" class="cell" data-execution_count="40">
<div class="sourceCode cell-code" id="cb74"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(A, origin<span class="op">=</span><span class="st">'upper'</span>)  <span class="co"># origin="upper" to set the origin at the top left</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-40-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>The main difference between <code>matshow</code> and <code>imshow</code> is that <code>matshow</code> is specifically designed for displaying matrices, while <code>imshow</code> is more general and can be used for both 2D arrays and images. <code>matshow</code> automatically adjusts the aspect ratio to make the matrix square, while <code>imshow</code> does not. Also the interpolation method used by <code>matshow</code> is different from that used by <code>imshow</code>, which can affect the appearance of the image.</p>
<p>Images are represneted as 3d arays: every entry is a the intensity of a pixel (if the image is grayscale) or the intensity of a colour (e.g.&nbsp;red, green or blue) if the image is in colour.</p>
<div id="dfc2dae5" class="cell" data-execution_count="41">
<div class="sourceCode cell-code" id="cb75"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimage <span class="im">import</span> data <span class="co"># importing images from a popular image library</span></span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-3"><a href="#cb75-3" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> data.camera() <span class="co"># a grayscale image</span></span>
<span id="cb75-4"><a href="#cb75-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb75-5"><a href="#cb75-5" aria-hidden="true" tabindex="-1"></a>plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># display the image in grayscale</span></span>
<span id="cb75-6"><a href="#cb75-6" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-41-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>Letâ€™s take a colour image</p>
<div id="bb663748" class="cell" data-execution_count="42">
<div class="sourceCode cell-code" id="cb76"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>color_image <span class="op">=</span> data.chelsea()</span>
<span id="cb76-2"><a href="#cb76-2" aria-hidden="true" tabindex="-1"></a>plt.imshow(color_image)  <span class="co"># display the color image</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-42-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>This is no longer just a 2d array, it has a third dimension for the colour channels (red, green, blue). We can access the individual colour channels by slicing the array along the third dimension.</p>
<div id="deb9899a" class="cell" data-execution_count="43">
<div class="sourceCode cell-code" id="cb77"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>color_image.shape</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="42">
<pre><code>(300, 451, 3)</code></pre>
</div>
</div>
<p>We can slice the array to get the various channels (notice that we specify the <strong>colormap</strong> <code>cmap</code> argument to display the channels in the appropriate colour):</p>
<div id="9ba44892" class="cell" data-execution_count="44">
<div class="sourceCode cell-code" id="cb79"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))  <span class="co"># create a figure with 3 subplots</span></span>
<span id="cb79-2"><a href="#cb79-2" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].imshow(color_image[:, :, <span class="dv">0</span>], cmap<span class="op">=</span><span class="st">'Reds'</span>)  <span class="co"># display the red channel</span></span>
<span id="cb79-3"><a href="#cb79-3" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Red Channel'</span>)</span>
<span id="cb79-4"><a href="#cb79-4" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].imshow(color_image[:, :, <span class="dv">1</span>], cmap<span class="op">=</span><span class="st">'Greens'</span>)  <span class="co"># display the green channel</span></span>
<span id="cb79-5"><a href="#cb79-5" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Green Channel'</span>)</span>
<span id="cb79-6"><a href="#cb79-6" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].imshow(color_image[:, :, <span class="dv">2</span>], cmap<span class="op">=</span><span class="st">'Blues'</span>)  <span class="co"># display the blue channel</span></span>
<span id="cb79-7"><a href="#cb79-7" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Blue Channel'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display" data-execution_count="43">
<pre><code>Text(0.5, 1.0, 'Blue Channel')</code></pre>
</div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-44-output-2.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>If we want to subsample regions of an image, we can simply slice the array further in its rows and columns.</p>
<div id="8c418abf" class="cell" data-execution_count="45">
<div class="sourceCode cell-code" id="cb81"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(color_image[<span class="dv">100</span>:<span class="dv">250</span>, <span class="dv">100</span>:, <span class="dv">1</span>], cmap<span class="op">=</span><span class="st">'Greens'</span>)  <span class="co"># display the green channel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-45-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can also use boolean indexing to filter the image based on conditions.</p>
<p>For example, we can binarise it by applying a threshold</p>
<div id="5cb6adbd" class="cell" data-execution_count="46">
<div class="sourceCode cell-code" id="cb82"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>green <span class="op">=</span> color_image[:,:,<span class="dv">1</span>]</span>
<span id="cb82-2"><a href="#cb82-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb82-3"><a href="#cb82-3" aria-hidden="true" tabindex="-1"></a>plt.imshow(green<span class="op">&gt;</span><span class="dv">100</span>, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># display a binary image where pixels with green channel value &gt; 100 are white</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-46-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<p>We can even perform logical operations using <code>numpy</code></p>
<ul>
<li>AND with <code>&amp;</code></li>
<li>OR with <code>|</code></li>
<li>NOT with <code>~</code> or <code>np.logical_not</code></li>
</ul>
<div id="8f616961" class="cell" data-execution_count="47">
<div class="sourceCode cell-code" id="cb83"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>green <span class="op">=</span> color_image[:,:,<span class="dv">1</span>]</span>
<span id="cb83-2"><a href="#cb83-2" aria-hidden="true" tabindex="-1"></a>red <span class="op">=</span> color_image[:,:,<span class="dv">0</span>]</span>
<span id="cb83-3"><a href="#cb83-3" aria-hidden="true" tabindex="-1"></a>plt.imshow( (green<span class="op">&gt;</span><span class="dv">120</span>) <span class="op">&amp;</span> (red<span class="op">&gt;</span><span class="dv">120</span>) , cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-47-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
<div id="70ea3c41" class="cell" data-execution_count="48">
<div class="sourceCode cell-code" id="cb84"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.logical_not(green<span class="op">&gt;</span><span class="dv">100</span>), cmap<span class="op">=</span><span class="st">'gray'</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div>
<figure class="figure">
<p><img src="lecture_multidimensionalArrays_files/figure-html/cell-48-output-1.png" class="img-fluid figure-img"></p>
</figure>
</div>
</div>
</div>
</section>
<section id="pair-programming" class="level2">
<h2 class="anchored" data-anchor-id="pair-programming">Pair programming</h2>
<p>The following exercise will allow you explore multi-dimensional arrays by <strong>working in pairs</strong>. One person will write the code, while the other will explain what the code does. You can switch roles after each exercise.</p>
<p>There are two parts so, you can switch roles after each part.</p>
<ul>
<li><a href="../10/exercises_part1.html">Part1</a></li>
<li><a href="../10/exercises_part2.html">Part2</a></li>
</ul>


<!-- -->

<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<div id="exercise-loading-indicator" class="exercise-loading-indicator d-none d-flex align-items-center gap-2">
<div id="exercise-loading-status" class="d-flex gap-2">

</div>
<div class="spinner-grow spinner-grow-sm">

</div>
</div>
<script type="vfs-file">
W10=
</script>
</section>

</main> <!-- /main -->
<script type="ojs-module-contents">
eyJjb250ZW50cyI6W119
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../../10";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "..";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "î§‹";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
        const codeEl = trigger.previousElementSibling.cloneNode(true);
        for (const childEl of codeEl.children) {
          if (isCodeAnnotation(childEl)) {
            childEl.remove();
          }
        }
        return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
    const viewSource = window.document.getElementById('quarto-view-source') ||
                       window.document.getElementById('quarto-code-tools-source');
    if (viewSource) {
      const sourceUrl = viewSource.getAttribute("data-quarto-source-url");
      viewSource.addEventListener("click", function(e) {
        if (sourceUrl) {
          // rstudio viewer pane
          if (/\bcapabilities=\b/.test(window.location)) {
            window.open(sourceUrl);
          } else {
            window.location.href = sourceUrl;
          }
        } else {
          const modal = new bootstrap.Modal(document.getElementById('quarto-embedded-source-code-modal'));
          modal.show();
        }
        return false;
      });
    }
    function toggleCodeHandler(show) {
      return function(e) {
        const detailsSrc = window.document.querySelectorAll(".cell > details > .sourceCode");
        for (let i=0; i<detailsSrc.length; i++) {
          const details = detailsSrc[i].parentElement;
          if (show) {
            details.open = true;
          } else {
            details.removeAttribute("open");
          }
        }
        const cellCodeDivs = window.document.querySelectorAll(".cell > .sourceCode");
        const fromCls = show ? "hidden" : "unhidden";
        const toCls = show ? "unhidden" : "hidden";
        for (let i=0; i<cellCodeDivs.length; i++) {
          const codeDiv = cellCodeDivs[i];
          if (codeDiv.classList.contains(fromCls)) {
            codeDiv.classList.remove(fromCls);
            codeDiv.classList.add(toCls);
          } 
        }
        return false;
      }
    }
    const hideAllCode = window.document.getElementById("quarto-hide-all-code");
    if (hideAllCode) {
      hideAllCode.addEventListener("click", toggleCodeHandler(false));
    }
    const showAllCode = window.document.getElementById("quarto-show-all-code");
    if (showAllCode) {
      showAllCode.addEventListener("click", toggleCodeHandler(true));
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
            // target, if specified
            link.setAttribute("target", "_blank");
            if (link.getAttribute("rel") === null) {
              link.setAttribute("rel", "noopener");
            }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script><div class="modal fade" id="quarto-embedded-source-code-modal" tabindex="-1" aria-labelledby="quarto-embedded-source-code-modal-label" aria-hidden="true"><div class="modal-dialog modal-dialog-scrollable"><div class="modal-content"><div class="modal-header"><h5 class="modal-title" id="quarto-embedded-source-code-modal-label">Source Code</h5><button class="btn-close" data-bs-dismiss="modal"></button></div><div class="modal-body"><div class="">
<div class="sourceCode" id="cb85" data-shortcodes="false"><pre class="sourceCode markdown code-with-copy"><code class="sourceCode markdown"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb85-2"><a href="#cb85-2" aria-hidden="true" tabindex="-1"></a><span class="an">title:</span><span class="co"> Multi-dimensional arrays</span></span>
<span id="cb85-3"><a href="#cb85-3" aria-hidden="true" tabindex="-1"></a><span class="an">jupyter:</span><span class="co"> python3</span></span>
<span id="cb85-4"><a href="#cb85-4" aria-hidden="true" tabindex="-1"></a><span class="co">---</span></span>
<span id="cb85-5"><a href="#cb85-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-6"><a href="#cb85-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-7"><a href="#cb85-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-8"><a href="#cb85-8" aria-hidden="true" tabindex="-1"></a>A <span class="in">`numpy.ndarray`</span> is the more complete term for a <span class="in">`numpy`</span> <span class="in">`array`</span> object. Up until this point we have mainly been dealing with and using one dimensional arrays. Numpy arrays (unlike lists) have the concept of shape whicih means they can be multi-dimensional. This means they can represent a grid (2D), a cuboid (3D) and so forth.</span>
<span id="cb85-9"><a href="#cb85-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-10"><a href="#cb85-10" aria-hidden="true" tabindex="-1"></a>The code below generates a <span class="in">`numpy.array`</span> object containing random numbers. This is a 2D array with a 3 x 3 shape:</span>
<span id="cb85-11"><a href="#cb85-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-14"><a href="#cb85-14" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-15"><a href="#cb85-15" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> numpy <span class="im">import</span> random</span>
<span id="cb85-16"><a href="#cb85-16" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-17"><a href="#cb85-17" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> random.default_rng(seed<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb85-18"><a href="#cb85-18" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-19"><a href="#cb85-19" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-22"><a href="#cb85-22" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-23"><a href="#cb85-23" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb85-24"><a href="#cb85-24" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-25"><a href="#cb85-25" aria-hidden="true" tabindex="-1"></a>shape <span class="op">=</span> (<span class="dv">3</span>,<span class="dv">3</span>)</span>
<span id="cb85-26"><a href="#cb85-26" aria-hidden="true" tabindex="-1"></a>array1 <span class="op">=</span> rng.random(shape)</span>
<span id="cb85-27"><a href="#cb85-27" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1.shape)</span>
<span id="cb85-28"><a href="#cb85-28" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1)</span>
<span id="cb85-29"><a href="#cb85-29" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-30"><a href="#cb85-30" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-31"><a href="#cb85-31" aria-hidden="true" tabindex="-1"></a>We can select one element from this array using the following syntax. We still use square brackets and pass an index value but now we can pass values for each dimension seperated by a comma (<span class="in">`,`</span>). This index is selecting the third column within the second row:</span>
<span id="cb85-32"><a href="#cb85-32" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-35"><a href="#cb85-35" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-36"><a href="#cb85-36" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">1</span>, <span class="dv">2</span>])</span>
<span id="cb85-37"><a href="#cb85-37" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-38"><a href="#cb85-38" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-39"><a href="#cb85-39" aria-hidden="true" tabindex="-1"></a>Using slicing (*Start:Stop*) syntax you can select an entire dimension at once by omitting both the Start and Stop values and just using <span class="in">`:`</span>. You can see how this works if you try the slice with just the Start or just the Stop e.g.</span>
<span id="cb85-40"><a href="#cb85-40" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-43"><a href="#cb85-43" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-44"><a href="#cb85-44" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[:<span class="dv">2</span>])</span>
<span id="cb85-45"><a href="#cb85-45" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">2</span>:])</span>
<span id="cb85-46"><a href="#cb85-46" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-47"><a href="#cb85-47" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-48"><a href="#cb85-48" aria-hidden="true" tabindex="-1"></a>Not including a Start index includes values from the beginning of the array/list etc. up to (but not including) the Stop.</span>
<span id="cb85-49"><a href="#cb85-49" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-50"><a href="#cb85-50" aria-hidden="true" tabindex="-1"></a>Not including a Stop index reads from the Start to the end of the array/list etc.</span>
<span id="cb85-51"><a href="#cb85-51" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-52"><a href="#cb85-52" aria-hidden="true" tabindex="-1"></a>So just using <span class="in">`:`</span> with no Start or Stop selects all elements for that dimension.</span>
<span id="cb85-53"><a href="#cb85-53" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-54"><a href="#cb85-54" aria-hidden="true" tabindex="-1"></a>This following syntax returns first row (first row, every column):</span>
<span id="cb85-55"><a href="#cb85-55" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-58"><a href="#cb85-58" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-59"><a href="#cb85-59" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[<span class="dv">0</span>,:])</span>
<span id="cb85-60"><a href="#cb85-60" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-61"><a href="#cb85-61" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-62"><a href="#cb85-62" aria-hidden="true" tabindex="-1"></a>And this would return the first column (every row, first column):</span>
<span id="cb85-63"><a href="#cb85-63" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-66"><a href="#cb85-66" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-67"><a href="#cb85-67" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(array1[:,<span class="dv">0</span>])</span>
<span id="cb85-68"><a href="#cb85-68" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-69"><a href="#cb85-69" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-70"><a href="#cb85-70" aria-hidden="true" tabindex="-1"></a><span class="in">`numpy`</span> <span class="in">`array`</span> objects store data in **row-major** order. Essentially this means for a 2D index this would be the equivalent of <span class="co">[</span><span class="ot">y, x</span><span class="co">]</span> rather than <span class="co">[</span><span class="ot">x, y</span><span class="co">]</span>.</span>
<span id="cb85-71"><a href="#cb85-71" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-72"><a href="#cb85-72" aria-hidden="true" tabindex="-1"></a><span class="fu">## Basic properties of multi-dimensional arrays</span></span>
<span id="cb85-73"><a href="#cb85-73" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-74"><a href="#cb85-74" aria-hidden="true" tabindex="-1"></a><span class="fu">### Shape</span></span>
<span id="cb85-75"><a href="#cb85-75" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-76"><a href="#cb85-76" aria-hidden="true" tabindex="-1"></a>The **shape** of a multi-dimensional array is a tuple that describes the size of each dimension. For example, a 2D array with 3 rows and 4 columns has a shape of <span class="in">`(3, 4)`</span>. You can access the shape of an array using the <span class="in">`.shape`</span> attribute.</span>
<span id="cb85-77"><a href="#cb85-77" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-78"><a href="#cb85-78" aria-hidden="true" tabindex="-1"></a>We can use many of the array initialisation functions we haver seen for 1d arrays also to create multi-dimensional arrays. For example, we can use <span class="in">`np.zeros`</span> to create a 2D array of zeros, or <span class="in">`np.ones`</span> to create a 2D array of ones. We can also use <span class="in">`np.random.rand`</span> to create a 2D array of random numbers.</span>
<span id="cb85-79"><a href="#cb85-79" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-82"><a href="#cb85-82" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-83"><a href="#cb85-83" aria-hidden="true" tabindex="-1"></a>array_of_zeros <span class="op">=</span> np.zeros(shape<span class="op">=</span>(<span class="dv">2</span>, <span class="dv">3</span>)) <span class="co"># 2 rows, 3 columns</span></span>
<span id="cb85-84"><a href="#cb85-84" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-85"><a href="#cb85-85" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-88"><a href="#cb85-88" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-89"><a href="#cb85-89" aria-hidden="true" tabindex="-1"></a>np.ones_like(array_of_zeros)</span>
<span id="cb85-90"><a href="#cb85-90" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-91"><a href="#cb85-91" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-92"><a href="#cb85-92" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-93"><a href="#cb85-93" aria-hidden="true" tabindex="-1"></a><span class="fu">### Axis and Rank</span></span>
<span id="cb85-94"><a href="#cb85-94" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-95"><a href="#cb85-95" aria-hidden="true" tabindex="-1"></a>A multi-dimensional array has multiple dimensions, each of which can be thought of as an **axis**. The number of dimensions is called the **rank** of the array. For example, a 2D array has a rank of 2, while a 3D array has a rank of 3. It is accessible via the <span class="in">`.ndim`</span> attribute.</span>
<span id="cb85-96"><a href="#cb85-96" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-97"><a href="#cb85-97" aria-hidden="true" tabindex="-1"></a>We typically call a rank 2 array a **matrix**. A rank 3 array (or higher) is often called a **tensor**. </span>
<span id="cb85-98"><a href="#cb85-98" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-101"><a href="#cb85-101" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-102"><a href="#cb85-102" aria-hidden="true" tabindex="-1"></a>rng <span class="op">=</span> random.default_rng(seed<span class="op">=</span><span class="dv">24</span>)</span>
<span id="cb85-103"><a href="#cb85-103" aria-hidden="true" tabindex="-1"></a>random_matrix <span class="op">=</span> rng.uniform(<span class="op">-</span><span class="dv">1</span>,<span class="dv">1</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">5</span>)) <span class="co"># random floats between -1 and 1, 2 rows, 5 columns</span></span>
<span id="cb85-104"><a href="#cb85-104" aria-hidden="true" tabindex="-1"></a>random_matrix</span>
<span id="cb85-105"><a href="#cb85-105" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-106"><a href="#cb85-106" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-109"><a href="#cb85-109" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-110"><a href="#cb85-110" aria-hidden="true" tabindex="-1"></a>random_matrix.ndim <span class="co"># two dimensions, rank 2, a matrix</span></span>
<span id="cb85-111"><a href="#cb85-111" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-112"><a href="#cb85-112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-115"><a href="#cb85-115" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-116"><a href="#cb85-116" aria-hidden="true" tabindex="-1"></a>random_tensor <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">3</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)) <span class="co"># random integes in [0,3), 2x3x4 tensor</span></span>
<span id="cb85-117"><a href="#cb85-117" aria-hidden="true" tabindex="-1"></a>random_tensor</span>
<span id="cb85-118"><a href="#cb85-118" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-119"><a href="#cb85-119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-122"><a href="#cb85-122" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-123"><a href="#cb85-123" aria-hidden="true" tabindex="-1"></a>random_tensor.ndim</span>
<span id="cb85-124"><a href="#cb85-124" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-125"><a href="#cb85-125" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-126"><a href="#cb85-126" aria-hidden="true" tabindex="-1"></a>We can perform operations along specific axes of a multi-dimensional array. For example, we can sum all the elements along a specific axis using the <span class="in">`np.sum`</span> function with the <span class="in">`axis`</span> parameter.</span>
<span id="cb85-127"><a href="#cb85-127" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-130"><a href="#cb85-130" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-131"><a href="#cb85-131" aria-hidden="true" tabindex="-1"></a>small_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">2</span>,size<span class="op">=</span>(<span class="dv">3</span>,<span class="dv">2</span>)) </span>
<span id="cb85-132"><a href="#cb85-132" aria-hidden="true" tabindex="-1"></a>small_matrix</span>
<span id="cb85-133"><a href="#cb85-133" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-134"><a href="#cb85-134" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-137"><a href="#cb85-137" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-138"><a href="#cb85-138" aria-hidden="true" tabindex="-1"></a>small_matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># sum along the first axis (rows)</span></span>
<span id="cb85-139"><a href="#cb85-139" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-140"><a href="#cb85-140" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-143"><a href="#cb85-143" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-144"><a href="#cb85-144" aria-hidden="true" tabindex="-1"></a>small_matrix.<span class="bu">sum</span>(axis<span class="op">=</span><span class="dv">1</span>) <span class="co"># sum along the second axis (columns), can you explain the resulting shape?</span></span>
<span id="cb85-145"><a href="#cb85-145" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-146"><a href="#cb85-146" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-147"><a href="#cb85-147" aria-hidden="true" tabindex="-1"></a>One can do the same also with useful statistical descriptors such as <span class="in">`np.mean`</span>, <span class="in">`np.std`</span>, etc.</span>
<span id="cb85-148"><a href="#cb85-148" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-151"><a href="#cb85-151" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-152"><a href="#cb85-152" aria-hidden="true" tabindex="-1"></a>np.mean(small_matrix, axis<span class="op">=</span><span class="dv">0</span>) <span class="co"># mean along the first axis (rows)</span></span>
<span id="cb85-153"><a href="#cb85-153" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-154"><a href="#cb85-154" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-155"><a href="#cb85-155" aria-hidden="true" tabindex="-1"></a><span class="fu">### Slicing</span></span>
<span id="cb85-156"><a href="#cb85-156" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-157"><a href="#cb85-157" aria-hidden="true" tabindex="-1"></a>Slicing works similarly to 1D arrays, but you can slice along multiple axes. For example, you can slice a 2D array to get a submatrix or a specific row or column.</span>
<span id="cb85-158"><a href="#cb85-158" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-161"><a href="#cb85-161" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-162"><a href="#cb85-162" aria-hidden="true" tabindex="-1"></a>small_matrix[:, <span class="dv">0</span>] <span class="co"># all rows, first column</span></span>
<span id="cb85-163"><a href="#cb85-163" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-164"><a href="#cb85-164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-167"><a href="#cb85-167" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-168"><a href="#cb85-168" aria-hidden="true" tabindex="-1"></a>small_matrix[:<span class="dv">2</span>,:] <span class="co"># first two rows, all columns</span></span>
<span id="cb85-169"><a href="#cb85-169" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-170"><a href="#cb85-170" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-173"><a href="#cb85-173" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-174"><a href="#cb85-174" aria-hidden="true" tabindex="-1"></a>small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb85-175"><a href="#cb85-175" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-176"><a href="#cb85-176" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-177"><a href="#cb85-177" aria-hidden="true" tabindex="-1"></a><span class="fu">### Reshaping and flattening</span></span>
<span id="cb85-178"><a href="#cb85-178" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-179"><a href="#cb85-179" aria-hidden="true" tabindex="-1"></a>The last example show an inetresting case: we extracted a single column from the matrix, but it is still a 2D array with shape <span class="in">`(3, 1)`</span>.</span>
<span id="cb85-180"><a href="#cb85-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-183"><a href="#cb85-183" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-184"><a href="#cb85-184" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb85-185"><a href="#cb85-185" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-186"><a href="#cb85-186" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"shape"</span>, selection.shape)</span>
<span id="cb85-187"><a href="#cb85-187" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"rank"</span>, selection.ndim)</span>
<span id="cb85-188"><a href="#cb85-188" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-189"><a href="#cb85-189" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-190"><a href="#cb85-190" aria-hidden="true" tabindex="-1"></a>What if we wanted a truly 1d array (rank 1)? We need to **reshape** the array. </span>
<span id="cb85-191"><a href="#cb85-191" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-192"><a href="#cb85-192" aria-hidden="true" tabindex="-1"></a>We can use the <span class="in">`np.reshape`</span> function to change the shape of an array without changing its data. For example, we can reshape a 2D array into a 1D array or vice versa.</span>
<span id="cb85-193"><a href="#cb85-193" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-194"><a href="#cb85-194" aria-hidden="true" tabindex="-1"></a>Reshape takes a tuple of the new shape as an argument. If you want to flatten an array (convert it to a 1D array), you can use <span class="in">`-1`</span> as one of the dimensions, which tells NumPy to infer the size of that dimension based on the total number of elements.</span>
<span id="cb85-195"><a href="#cb85-195" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-198"><a href="#cb85-198" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-199"><a href="#cb85-199" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb85-200"><a href="#cb85-200" aria-hidden="true" tabindex="-1"></a>reshaped_selection <span class="op">=</span> selection.reshape((<span class="dv">3</span>,))  <span class="co"># reshape to a 1D array excplicitly</span></span>
<span id="cb85-201"><a href="#cb85-201" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped shape"</span>, reshaped_selection.shape)</span>
<span id="cb85-202"><a href="#cb85-202" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped rank"</span>, reshaped_selection.ndim)</span>
<span id="cb85-203"><a href="#cb85-203" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped selection"</span>, reshaped_selection)</span>
<span id="cb85-204"><a href="#cb85-204" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-205"><a href="#cb85-205" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-208"><a href="#cb85-208" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-209"><a href="#cb85-209" aria-hidden="true" tabindex="-1"></a><span class="co">#same code as above, but with inferred shape</span></span>
<span id="cb85-210"><a href="#cb85-210" aria-hidden="true" tabindex="-1"></a>selection <span class="op">=</span> small_matrix[::<span class="op">-</span><span class="dv">1</span>,:<span class="dv">1</span>]</span>
<span id="cb85-211"><a href="#cb85-211" aria-hidden="true" tabindex="-1"></a>reshaped_selection <span class="op">=</span> selection.reshape(<span class="op">-</span><span class="dv">1</span>)  <span class="co"># infererd shape</span></span>
<span id="cb85-212"><a href="#cb85-212" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped shape"</span>, reshaped_selection.shape)</span>
<span id="cb85-213"><a href="#cb85-213" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped rank"</span>, reshaped_selection.ndim)</span>
<span id="cb85-214"><a href="#cb85-214" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"reshaped selection"</span>, reshaped_selection)</span>
<span id="cb85-215"><a href="#cb85-215" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-216"><a href="#cb85-216" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-217"><a href="#cb85-217" aria-hidden="true" tabindex="-1"></a>Another way to cast a multi-dimensional array to a 1D array is to use the <span class="in">`np.ravel()`</span> function, which returns a flattened view of the array (not a copy).</span>
<span id="cb85-218"><a href="#cb85-218" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-221"><a href="#cb85-221" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-222"><a href="#cb85-222" aria-hidden="true" tabindex="-1"></a>a_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># random integers in [0,10), 2x3 matrix</span></span>
<span id="cb85-223"><a href="#cb85-223" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original matrix:</span><span class="ch">\n</span><span class="st">"</span>, a_matrix)</span>
<span id="cb85-224"><a href="#cb85-224" aria-hidden="true" tabindex="-1"></a>ravelled_view <span class="op">=</span> a_matrix.ravel()</span>
<span id="cb85-225"><a href="#cb85-225" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened view:"</span>, ravelled_view)  <span class="co"># flatten the array to a 1D array</span></span>
<span id="cb85-226"><a href="#cb85-226" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-227"><a href="#cb85-227" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-228"><a href="#cb85-228" aria-hidden="true" tabindex="-1"></a>If we modify the view, we modify the original array as well.</span>
<span id="cb85-229"><a href="#cb85-229" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-232"><a href="#cb85-232" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-233"><a href="#cb85-233" aria-hidden="true" tabindex="-1"></a>ravelled_view[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># modify the view</span></span>
<span id="cb85-234"><a href="#cb85-234" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Modified view:"</span>, ravelled_view)  <span class="co"># the view is modified</span></span>
<span id="cb85-235"><a href="#cb85-235" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Original array:"</span>, a_matrix)  <span class="co"># the original array is modified as well</span></span>
<span id="cb85-236"><a href="#cb85-236" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-237"><a href="#cb85-237" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-238"><a href="#cb85-238" aria-hidden="true" tabindex="-1"></a>To obtain a completely independent flattened copy of the array, you can use the <span class="in">`np.flatten()`</span> method, which returns a copy of the array in a 1D format.</span>
<span id="cb85-239"><a href="#cb85-239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-242"><a href="#cb85-242" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-243"><a href="#cb85-243" aria-hidden="true" tabindex="-1"></a>a_matrix <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">2</span>,<span class="dv">3</span>)) <span class="co"># random integers in [0,10), 2x3 matrix</span></span>
<span id="cb85-244"><a href="#cb85-244" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The original:</span><span class="ch">\n</span><span class="st">"</span>,a_matrix)</span>
<span id="cb85-245"><a href="#cb85-245" aria-hidden="true" tabindex="-1"></a>flattened_copy <span class="op">=</span> a_matrix.flatten()</span>
<span id="cb85-246"><a href="#cb85-246" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened:"</span>,flattened_copy)  <span class="co"># flatten the array to a 1D array</span></span>
<span id="cb85-247"><a href="#cb85-247" aria-hidden="true" tabindex="-1"></a>flattened_copy[<span class="dv">0</span>] <span class="op">=</span> <span class="dv">100</span>  <span class="co"># modify the copy</span></span>
<span id="cb85-248"><a href="#cb85-248" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Flattened after modification:"</span>,flattened_copy)  <span class="co"># the copy is modified</span></span>
<span id="cb85-249"><a href="#cb85-249" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"The original:</span><span class="ch">\n</span><span class="st">"</span>,a_matrix)  <span class="co"># the original array is not modified</span></span>
<span id="cb85-250"><a href="#cb85-250" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-251"><a href="#cb85-251" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-252"><a href="#cb85-252" aria-hidden="true" tabindex="-1"></a>We can also do the opposite and increase the rank of an array by reshaping it. For example, we can reshape a 1D array into a 2D array with one column or one row.</span>
<span id="cb85-253"><a href="#cb85-253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-256"><a href="#cb85-256" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-257"><a href="#cb85-257" aria-hidden="true" tabindex="-1"></a>one_dimensional_array <span class="op">=</span> rng.integers(<span class="dv">0</span>,<span class="dv">10</span>,size<span class="op">=</span>(<span class="dv">5</span>,))  <span class="co"># random integers in [0,10), 1D array</span></span>
<span id="cb85-258"><a href="#cb85-258" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"One-dimensional array:"</span>, one_dimensional_array)</span>
<span id="cb85-259"><a href="#cb85-259" aria-hidden="true" tabindex="-1"></a>reshaped_array <span class="op">=</span> one_dimensional_array.reshape((<span class="dv">5</span>,<span class="dv">1</span>))  <span class="co"># reshape to a  2D array with one column</span></span>
<span id="cb85-260"><a href="#cb85-260" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Reshaped array:</span><span class="ch">\n</span><span class="st">"</span>, reshaped_array)</span>
<span id="cb85-261"><a href="#cb85-261" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-262"><a href="#cb85-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-263"><a href="#cb85-263" aria-hidden="true" tabindex="-1"></a><span class="fu">### Broadcasting</span></span>
<span id="cb85-264"><a href="#cb85-264" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-265"><a href="#cb85-265" aria-hidden="true" tabindex="-1"></a>Combining arrays of different shapes is possible in NumPy using a feature called **broadcasting**. Broadcasting allows NumPy to perform operations on arrays of different shapes by automatically expanding the smaller array to match the shape of the larger one.</span>
<span id="cb85-266"><a href="#cb85-266" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-269"><a href="#cb85-269" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-270"><a href="#cb85-270" aria-hidden="true" tabindex="-1"></a><span class="co"># Minimal broadcasting example: rank 2 (matrix) with rank 1 (vector)</span></span>
<span id="cb85-271"><a href="#cb85-271" aria-hidden="true" tabindex="-1"></a>matrix <span class="op">=</span> np.array([[<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>],</span>
<span id="cb85-272"><a href="#cb85-272" aria-hidden="true" tabindex="-1"></a>                   [<span class="dv">4</span>, <span class="dv">5</span>, <span class="dv">6</span>]])</span>
<span id="cb85-273"><a href="#cb85-273" aria-hidden="true" tabindex="-1"></a>vector <span class="op">=</span> np.array([<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>])</span>
<span id="cb85-274"><a href="#cb85-274" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-275"><a href="#cb85-275" aria-hidden="true" tabindex="-1"></a><span class="co"># Broadcasting addition: vector is added to each row of the matrix</span></span>
<span id="cb85-276"><a href="#cb85-276" aria-hidden="true" tabindex="-1"></a>result <span class="op">=</span> matrix <span class="op">+</span> vector</span>
<span id="cb85-277"><a href="#cb85-277" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix:</span><span class="ch">\n</span><span class="st">"</span>, matrix)</span>
<span id="cb85-278"><a href="#cb85-278" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vector:"</span>, vector)</span>
<span id="cb85-279"><a href="#cb85-279" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Result of broadcasting:</span><span class="ch">\n</span><span class="st">"</span>, result)</span>
<span id="cb85-280"><a href="#cb85-280" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-281"><a href="#cb85-281" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-282"><a href="#cb85-282" aria-hidden="true" tabindex="-1"></a>You can reshape a 1D array to a column or row vector and use broadcasting to expand it into a large table. For example, to create a table where each row is the original 1D array, or each column is the original array:</span>
<span id="cb85-283"><a href="#cb85-283" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-286"><a href="#cb85-286" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-287"><a href="#cb85-287" aria-hidden="true" tabindex="-1"></a>one_dimensional_array <span class="op">=</span> np.linspace(<span class="dv">1</span>, <span class="dv">5</span>, num<span class="op">=</span><span class="dv">5</span>)  <span class="co"># create a 1D array with 5 elements</span></span>
<span id="cb85-288"><a href="#cb85-288" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"One-dimensional array:"</span>, one_dimensional_array)</span>
<span id="cb85-289"><a href="#cb85-289" aria-hidden="true" tabindex="-1"></a><span class="co"># Expand one_dimensional_array to a table with 5 rows and 5 columns</span></span>
<span id="cb85-290"><a href="#cb85-290" aria-hidden="true" tabindex="-1"></a>row_vector <span class="op">=</span> one_dimensional_array.reshape(<span class="dv">1</span>, <span class="op">-</span><span class="dv">1</span>)  <span class="co"># shape (1, 5)</span></span>
<span id="cb85-291"><a href="#cb85-291" aria-hidden="true" tabindex="-1"></a>column_vector <span class="op">=</span> one_dimensional_array.reshape(<span class="op">-</span><span class="dv">1</span>, <span class="dv">1</span>)  <span class="co"># shape (5, 1)</span></span>
<span id="cb85-292"><a href="#cb85-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-293"><a href="#cb85-293" aria-hidden="true" tabindex="-1"></a><span class="co"># Broadcasting to create a table</span></span>
<span id="cb85-294"><a href="#cb85-294" aria-hidden="true" tabindex="-1"></a>table <span class="op">=</span> column_vector <span class="op">+</span> row_vector</span>
<span id="cb85-295"><a href="#cb85-295" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"BroadcastedTable:</span><span class="ch">\n</span><span class="st">"</span>,table)</span>
<span id="cb85-296"><a href="#cb85-296" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-297"><a href="#cb85-297" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-298"><a href="#cb85-298" aria-hidden="true" tabindex="-1"></a><span class="fu">## Two-dimensional arrays as matrices: some linear algebra</span></span>
<span id="cb85-299"><a href="#cb85-299" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-300"><a href="#cb85-300" aria-hidden="true" tabindex="-1"></a>Two-dimensional arrays are often used to represent matrices or images. In a matrix, each element can be accessed using two indices: </span>
<span id="cb85-301"><a href="#cb85-301" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>one for the row </span>
<span id="cb85-302"><a href="#cb85-302" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>one for the column. </span>
<span id="cb85-303"><a href="#cb85-303" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-304"><a href="#cb85-304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-305"><a href="#cb85-305" aria-hidden="true" tabindex="-1"></a>A matrix is a rectangular array of numbers, symbols, or expressions arranged in rows and columns and is an essential concept in **linear algebra**.</span>
<span id="cb85-306"><a href="#cb85-306" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-307"><a href="#cb85-307" aria-hidden="true" tabindex="-1"></a>For examplle, let's consider the simple system of simultaneous equations:</span>
<span id="cb85-308"><a href="#cb85-308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-309"><a href="#cb85-309" aria-hidden="true" tabindex="-1"></a>$$ \begin{align*}</span>
<span id="cb85-310"><a href="#cb85-310" aria-hidden="true" tabindex="-1"></a>2x + 3y +z &amp;= 5 <span class="sc">\\</span></span>
<span id="cb85-311"><a href="#cb85-311" aria-hidden="true" tabindex="-1"></a>4x - y &amp;= 1 <span class="sc">\\</span></span>
<span id="cb85-312"><a href="#cb85-312" aria-hidden="true" tabindex="-1"></a>2y +z &amp;= 3</span>
<span id="cb85-313"><a href="#cb85-313" aria-hidden="true" tabindex="-1"></a>\end{align*} $$</span>
<span id="cb85-314"><a href="#cb85-314" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-315"><a href="#cb85-315" aria-hidden="true" tabindex="-1"></a>This can be represented in matrix form as:</span>
<span id="cb85-316"><a href="#cb85-316" aria-hidden="true" tabindex="-1"></a>$$ \begin{bmatrix}</span>
<span id="cb85-317"><a href="#cb85-317" aria-hidden="true" tabindex="-1"></a>2 &amp; 3 &amp;1  <span class="sc">\\</span></span>
<span id="cb85-318"><a href="#cb85-318" aria-hidden="true" tabindex="-1"></a>4 &amp; -1 &amp;0 <span class="sc">\\</span></span>
<span id="cb85-319"><a href="#cb85-319" aria-hidden="true" tabindex="-1"></a>0 &amp; 2 &amp;1</span>
<span id="cb85-320"><a href="#cb85-320" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb85-321"><a href="#cb85-321" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}</span>
<span id="cb85-322"><a href="#cb85-322" aria-hidden="true" tabindex="-1"></a>x <span class="sc">\\</span></span>
<span id="cb85-323"><a href="#cb85-323" aria-hidden="true" tabindex="-1"></a>y <span class="sc">\\</span></span>
<span id="cb85-324"><a href="#cb85-324" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb85-325"><a href="#cb85-325" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}</span>
<span id="cb85-326"><a href="#cb85-326" aria-hidden="true" tabindex="-1"></a>=</span>
<span id="cb85-327"><a href="#cb85-327" aria-hidden="true" tabindex="-1"></a>\begin{bmatrix}5 <span class="sc">\\</span></span>
<span id="cb85-328"><a href="#cb85-328" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\\</span></span>
<span id="cb85-329"><a href="#cb85-329" aria-hidden="true" tabindex="-1"></a>3</span>
<span id="cb85-330"><a href="#cb85-330" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} $$   </span>
<span id="cb85-331"><a href="#cb85-331" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-332"><a href="#cb85-332" aria-hidden="true" tabindex="-1"></a>And if we call $A$ the matrix of coefficients, $\mathbf{x}$ the vector of variables, and $b$ the vector of constants, we can write this as:</span>
<span id="cb85-333"><a href="#cb85-333" aria-hidden="true" tabindex="-1"></a>$$ A \mathbf{x} = \mathbf{b} $$</span>
<span id="cb85-334"><a href="#cb85-334" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-335"><a href="#cb85-335" aria-hidden="true" tabindex="-1"></a>where $$A = \begin{bmatrix}</span>
<span id="cb85-336"><a href="#cb85-336" aria-hidden="true" tabindex="-1"></a>2 &amp; 3 &amp;1  <span class="sc">\\</span></span>
<span id="cb85-337"><a href="#cb85-337" aria-hidden="true" tabindex="-1"></a>4 &amp; -1 &amp;0 <span class="sc">\\</span></span>
<span id="cb85-338"><a href="#cb85-338" aria-hidden="true" tabindex="-1"></a>0 &amp; 2 &amp;1</span>
<span id="cb85-339"><a href="#cb85-339" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}, \quad</span>
<span id="cb85-340"><a href="#cb85-340" aria-hidden="true" tabindex="-1"></a>\mathbf{x} = \begin{bmatrix}</span>
<span id="cb85-341"><a href="#cb85-341" aria-hidden="true" tabindex="-1"></a>x <span class="sc">\\</span></span>
<span id="cb85-342"><a href="#cb85-342" aria-hidden="true" tabindex="-1"></a>y<span class="sc">\\</span></span>
<span id="cb85-343"><a href="#cb85-343" aria-hidden="true" tabindex="-1"></a>z</span>
<span id="cb85-344"><a href="#cb85-344" aria-hidden="true" tabindex="-1"></a>\end{bmatrix}, \quad</span>
<span id="cb85-345"><a href="#cb85-345" aria-hidden="true" tabindex="-1"></a>\mathbf{b} = \begin{bmatrix}</span>
<span id="cb85-346"><a href="#cb85-346" aria-hidden="true" tabindex="-1"></a>5 <span class="sc">\\</span></span>
<span id="cb85-347"><a href="#cb85-347" aria-hidden="true" tabindex="-1"></a>1<span class="sc">\\</span></span>
<span id="cb85-348"><a href="#cb85-348" aria-hidden="true" tabindex="-1"></a>3</span>
<span id="cb85-349"><a href="#cb85-349" aria-hidden="true" tabindex="-1"></a>\end{bmatrix} $$            </span>
<span id="cb85-350"><a href="#cb85-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-351"><a href="#cb85-351" aria-hidden="true" tabindex="-1"></a>A key result of linear algebra is that if $A$ is invertible, we can solve for $\mathbf{x}$ by multiplying both sides of the equation by the inverse of $A$:</span>
<span id="cb85-352"><a href="#cb85-352" aria-hidden="true" tabindex="-1"></a>$$ \mathbf{x} = A^{-1} \mathbf{b} $$</span>
<span id="cb85-353"><a href="#cb85-353" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-354"><a href="#cb85-354" aria-hidden="true" tabindex="-1"></a>where $A^{-1}$ is the inverse of matrix $A$.</span>
<span id="cb85-355"><a href="#cb85-355" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-356"><a href="#cb85-356" aria-hidden="true" tabindex="-1"></a>NumPy has a dedicated linear algebra submodule called <span class="in">`numpy.linalg`</span> that provides functions for performing various linear algebra operations, including matrix inversion, solving systems of equations, and computing eigenvalues and eigenvectors.</span>
<span id="cb85-357"><a href="#cb85-357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-358"><a href="#cb85-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-361"><a href="#cb85-361" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-362"><a href="#cb85-362" aria-hidden="true" tabindex="-1"></a>A <span class="op">=</span> np.array([[<span class="dv">2</span>, <span class="dv">3</span>,<span class="dv">1</span>], [<span class="dv">4</span>, <span class="op">-</span><span class="dv">1</span>,<span class="dv">0</span>],[<span class="dv">0</span>,<span class="dv">2</span>,<span class="dv">1</span>]])</span>
<span id="cb85-363"><a href="#cb85-363" aria-hidden="true" tabindex="-1"></a>b <span class="op">=</span> np.array([[<span class="dv">5</span>], [<span class="dv">1</span>], [<span class="dv">3</span>]]) <span class="co"># we use double brackets to create a column vector</span></span>
<span id="cb85-364"><a href="#cb85-364" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Matrix A:</span><span class="ch">\n</span><span class="st">"</span>, A)</span>
<span id="cb85-365"><a href="#cb85-365" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Vector b:</span><span class="ch">\n</span><span class="st">"</span>, b)</span>
<span id="cb85-366"><a href="#cb85-366" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-367"><a href="#cb85-367" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-368"><a href="#cb85-368" aria-hidden="true" tabindex="-1"></a>The linear algebra submodule has a function called <span class="in">`solve`</span> which can be used to solve the above equation efficiently:</span>
<span id="cb85-369"><a href="#cb85-369" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-372"><a href="#cb85-372" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-373"><a href="#cb85-373" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.solve(A, b)</span>
<span id="cb85-374"><a href="#cb85-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-375"><a href="#cb85-375" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb85-376"><a href="#cb85-376" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-377"><a href="#cb85-377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-378"><a href="#cb85-378" aria-hidden="true" tabindex="-1"></a>But we can use numpy to verify that this is correct. We can use the symbol <span class="in">`@`</span> to perform matrix multiplication in numpy. </span>
<span id="cb85-379"><a href="#cb85-379" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-382"><a href="#cb85-382" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-383"><a href="#cb85-383" aria-hidden="true" tabindex="-1"></a>A <span class="op">@</span> x</span>
<span id="cb85-384"><a href="#cb85-384" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-385"><a href="#cb85-385" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-386"><a href="#cb85-386" aria-hidden="true" tabindex="-1"></a>We can also directly calculate the inverse of a matrix using the <span class="in">`inv`</span> function from the <span class="in">`numpy.linalg`</span> and use it to solve the equation</span>
<span id="cb85-387"><a href="#cb85-387" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-390"><a href="#cb85-390" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-391"><a href="#cb85-391" aria-hidden="true" tabindex="-1"></a>x <span class="op">=</span> np.linalg.inv(A) <span class="op">@</span> b</span>
<span id="cb85-392"><a href="#cb85-392" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-393"><a href="#cb85-393" aria-hidden="true" tabindex="-1"></a>x</span>
<span id="cb85-394"><a href="#cb85-394" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-395"><a href="#cb85-395" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-396"><a href="#cb85-396" aria-hidden="true" tabindex="-1"></a>All the most common linear algebra operations are available in the <span class="in">`numpy.linalg`</span> submodule:</span>
<span id="cb85-397"><a href="#cb85-397" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-398"><a href="#cb85-398" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>tranpose</span>
<span id="cb85-399"><a href="#cb85-399" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-402"><a href="#cb85-402" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-403"><a href="#cb85-403" aria-hidden="true" tabindex="-1"></a>b.T</span>
<span id="cb85-404"><a href="#cb85-404" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-405"><a href="#cb85-405" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-406"><a href="#cb85-406" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>scalar (dot) product (which takes two vectors and returns a scalar)</span>
<span id="cb85-407"><a href="#cb85-407" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-410"><a href="#cb85-410" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-411"><a href="#cb85-411" aria-hidden="true" tabindex="-1"></a>np.dot(b.T,b)</span>
<span id="cb85-412"><a href="#cb85-412" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-413"><a href="#cb85-413" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-414"><a href="#cb85-414" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>cross product</span>
<span id="cb85-415"><a href="#cb85-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-418"><a href="#cb85-418" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-419"><a href="#cb85-419" aria-hidden="true" tabindex="-1"></a>np.cross(b.T, b.T) <span class="co">#takes row vectors and returns a row vector</span></span>
<span id="cb85-420"><a href="#cb85-420" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-421"><a href="#cb85-421" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-422"><a href="#cb85-422" aria-hidden="true" tabindex="-1"></a>Linear algebra applications are beyond the scope of this course (so, there will be **no assessment of these**), but they are widely used in various fields such as physics, computer science, and engineering. For example, they are essential in computer graphics for transformations, in machine learning for optimization, and in physics for solving systems of equations. So it is important for you to know that all these can be implemented efficiently using numpy.</span>
<span id="cb85-423"><a href="#cb85-423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-424"><a href="#cb85-424" aria-hidden="true" tabindex="-1"></a><span class="fu">## Matrices as images</span></span>
<span id="cb85-425"><a href="#cb85-425" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-426"><a href="#cb85-426" aria-hidden="true" tabindex="-1"></a>A two-dimensional table of numbers can also be used to represent an image. Each number in the table corresponds to a pixel in the image, and the value of the number represents the color or intensity of that pixel.</span>
<span id="cb85-427"><a href="#cb85-427" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-428"><a href="#cb85-428" aria-hidden="true" tabindex="-1"></a><span class="in">`matplotlib`</span> provides a convenient way to visualize 2D arrays as images. The <span class="in">`matshow`</span> function can be used to display a 2D matrix as an image, where the values in the array are mapped to colors.</span>
<span id="cb85-429"><a href="#cb85-429" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-432"><a href="#cb85-432" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-433"><a href="#cb85-433" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> matplotlib.pyplot <span class="im">as</span> plt</span>
<span id="cb85-434"><a href="#cb85-434" aria-hidden="true" tabindex="-1"></a>plt.matshow(A)</span>
<span id="cb85-435"><a href="#cb85-435" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb85-436"><a href="#cb85-436" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(A)</span>
<span id="cb85-437"><a href="#cb85-437" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-438"><a href="#cb85-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-439"><a href="#cb85-439" aria-hidden="true" tabindex="-1"></a>Notice that the indices of the y-axis increase as we go down. These are the indices of the rows in the matrix.</span>
<span id="cb85-440"><a href="#cb85-440" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-441"><a href="#cb85-441" aria-hidden="true" tabindex="-1"></a>For a matrix of a given shape we can get the indices using the <span class="in">`np.indices`</span> function, which returns a grid of indices for each dimension. This can be useful for creating masks or selecting specific regions of the matrix.</span>
<span id="cb85-442"><a href="#cb85-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-445"><a href="#cb85-445" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-446"><a href="#cb85-446" aria-hidden="true" tabindex="-1"></a>row_index, col_index <span class="op">=</span> np.indices(A.shape)</span>
<span id="cb85-447"><a href="#cb85-447" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Row indices:</span><span class="ch">\n</span><span class="st">"</span>, row_index)</span>
<span id="cb85-448"><a href="#cb85-448" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(<span class="st">"Column indices:</span><span class="ch">\n</span><span class="st">"</span>, col_index)</span>
<span id="cb85-449"><a href="#cb85-449" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-450"><a href="#cb85-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-451"><a href="#cb85-451" aria-hidden="true" tabindex="-1"></a>An alternative function is <span class="in">`imshow`</span>, which is more general and can be used for both 2D arrays and images.</span>
<span id="cb85-452"><a href="#cb85-452" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-453"><a href="#cb85-453" aria-hidden="true" tabindex="-1"></a>Here we can set the origin of the axis:</span>
<span id="cb85-454"><a href="#cb85-454" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-457"><a href="#cb85-457" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-458"><a href="#cb85-458" aria-hidden="true" tabindex="-1"></a>plt.imshow(A, origin<span class="op">=</span><span class="st">'lower'</span>)  <span class="co"># origin='lower' to set the origin at the bottom left</span></span>
<span id="cb85-459"><a href="#cb85-459" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-460"><a href="#cb85-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-463"><a href="#cb85-463" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-464"><a href="#cb85-464" aria-hidden="true" tabindex="-1"></a>plt.imshow(A, origin<span class="op">=</span><span class="st">'upper'</span>)  <span class="co"># origin="upper" to set the origin at the top left</span></span>
<span id="cb85-465"><a href="#cb85-465" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-466"><a href="#cb85-466" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-467"><a href="#cb85-467" aria-hidden="true" tabindex="-1"></a>The main difference between <span class="in">`matshow`</span> and <span class="in">`imshow`</span> is that <span class="in">`matshow`</span> is specifically designed for displaying matrices, while <span class="in">`imshow`</span> is more general and can be used for both 2D arrays and images. <span class="in">`matshow`</span> automatically adjusts the aspect ratio to make the matrix square, while <span class="in">`imshow`</span> does not. Also the interpolation method used by <span class="in">`matshow`</span> is different from that used by <span class="in">`imshow`</span>, which can affect the appearance of the image.</span>
<span id="cb85-468"><a href="#cb85-468" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-469"><a href="#cb85-469" aria-hidden="true" tabindex="-1"></a>Images are represneted as 3d arays: every entry is a the intensity of a pixel (if the image is grayscale) or the intensity of a colour (e.g. red, green or blue) if the image is in colour.</span>
<span id="cb85-470"><a href="#cb85-470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-473"><a href="#cb85-473" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-474"><a href="#cb85-474" aria-hidden="true" tabindex="-1"></a><span class="im">from</span> skimage <span class="im">import</span> data <span class="co"># importing images from a popular image library</span></span>
<span id="cb85-475"><a href="#cb85-475" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-476"><a href="#cb85-476" aria-hidden="true" tabindex="-1"></a>image <span class="op">=</span> data.camera() <span class="co"># a grayscale image</span></span>
<span id="cb85-477"><a href="#cb85-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-478"><a href="#cb85-478" aria-hidden="true" tabindex="-1"></a>plt.imshow(image, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># display the image in grayscale</span></span>
<span id="cb85-479"><a href="#cb85-479" aria-hidden="true" tabindex="-1"></a>plt.colorbar()</span>
<span id="cb85-480"><a href="#cb85-480" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-481"><a href="#cb85-481" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-482"><a href="#cb85-482" aria-hidden="true" tabindex="-1"></a>Let's take a colour image</span>
<span id="cb85-483"><a href="#cb85-483" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-486"><a href="#cb85-486" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-487"><a href="#cb85-487" aria-hidden="true" tabindex="-1"></a>color_image <span class="op">=</span> data.chelsea()</span>
<span id="cb85-488"><a href="#cb85-488" aria-hidden="true" tabindex="-1"></a>plt.imshow(color_image)  <span class="co"># display the color image</span></span>
<span id="cb85-489"><a href="#cb85-489" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-490"><a href="#cb85-490" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-491"><a href="#cb85-491" aria-hidden="true" tabindex="-1"></a>This is no longer just a 2d array, it has a third dimension for the colour channels (red, green, blue). We can access the individual colour channels by slicing the array along the third dimension.</span>
<span id="cb85-492"><a href="#cb85-492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-495"><a href="#cb85-495" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-496"><a href="#cb85-496" aria-hidden="true" tabindex="-1"></a>color_image.shape</span>
<span id="cb85-497"><a href="#cb85-497" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-498"><a href="#cb85-498" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-499"><a href="#cb85-499" aria-hidden="true" tabindex="-1"></a>We can slice the array to get the various channels (notice that we specify the **colormap** <span class="in">`cmap`</span> argument to display the channels in the appropriate colour):</span>
<span id="cb85-500"><a href="#cb85-500" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-503"><a href="#cb85-503" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-504"><a href="#cb85-504" aria-hidden="true" tabindex="-1"></a>fig,ax <span class="op">=</span> plt.subplots(<span class="dv">1</span>, <span class="dv">3</span>, figsize<span class="op">=</span>(<span class="dv">15</span>, <span class="dv">5</span>))  <span class="co"># create a figure with 3 subplots</span></span>
<span id="cb85-505"><a href="#cb85-505" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].imshow(color_image[:, :, <span class="dv">0</span>], cmap<span class="op">=</span><span class="st">'Reds'</span>)  <span class="co"># display the red channel</span></span>
<span id="cb85-506"><a href="#cb85-506" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">0</span>].set_title(<span class="st">'Red Channel'</span>)</span>
<span id="cb85-507"><a href="#cb85-507" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].imshow(color_image[:, :, <span class="dv">1</span>], cmap<span class="op">=</span><span class="st">'Greens'</span>)  <span class="co"># display the green channel</span></span>
<span id="cb85-508"><a href="#cb85-508" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">1</span>].set_title(<span class="st">'Green Channel'</span>)</span>
<span id="cb85-509"><a href="#cb85-509" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].imshow(color_image[:, :, <span class="dv">2</span>], cmap<span class="op">=</span><span class="st">'Blues'</span>)  <span class="co"># display the blue channel</span></span>
<span id="cb85-510"><a href="#cb85-510" aria-hidden="true" tabindex="-1"></a>ax[<span class="dv">2</span>].set_title(<span class="st">'Blue Channel'</span>)</span>
<span id="cb85-511"><a href="#cb85-511" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-512"><a href="#cb85-512" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-513"><a href="#cb85-513" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-514"><a href="#cb85-514" aria-hidden="true" tabindex="-1"></a>If we want to subsample regions of an image, we can simply slice the array further in its rows and columns.</span>
<span id="cb85-515"><a href="#cb85-515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-518"><a href="#cb85-518" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-519"><a href="#cb85-519" aria-hidden="true" tabindex="-1"></a>plt.imshow(color_image[<span class="dv">100</span>:<span class="dv">250</span>, <span class="dv">100</span>:, <span class="dv">1</span>], cmap<span class="op">=</span><span class="st">'Greens'</span>)  <span class="co"># display the green channel</span></span>
<span id="cb85-520"><a href="#cb85-520" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-521"><a href="#cb85-521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-522"><a href="#cb85-522" aria-hidden="true" tabindex="-1"></a>We can also use boolean indexing to filter the image based on conditions.</span>
<span id="cb85-523"><a href="#cb85-523" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-524"><a href="#cb85-524" aria-hidden="true" tabindex="-1"></a>For example, we can binarise it by applying a threshold</span>
<span id="cb85-525"><a href="#cb85-525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-528"><a href="#cb85-528" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-529"><a href="#cb85-529" aria-hidden="true" tabindex="-1"></a>green <span class="op">=</span> color_image[:,:,<span class="dv">1</span>]</span>
<span id="cb85-530"><a href="#cb85-530" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-531"><a href="#cb85-531" aria-hidden="true" tabindex="-1"></a>plt.imshow(green<span class="op">&gt;</span><span class="dv">100</span>, cmap<span class="op">=</span><span class="st">'gray'</span>)  <span class="co"># display a binary image where pixels with green channel value &gt; 100 are white</span></span>
<span id="cb85-532"><a href="#cb85-532" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-533"><a href="#cb85-533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-534"><a href="#cb85-534" aria-hidden="true" tabindex="-1"></a>We can even perform logical operations using <span class="in">`numpy`</span></span>
<span id="cb85-535"><a href="#cb85-535" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-536"><a href="#cb85-536" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>AND with <span class="in">`&amp;`</span></span>
<span id="cb85-537"><a href="#cb85-537" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>OR with <span class="in">`|`</span></span>
<span id="cb85-538"><a href="#cb85-538" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span>NOT with <span class="in">`~`</span> or <span class="in">`np.logical_not`</span></span>
<span id="cb85-539"><a href="#cb85-539" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-542"><a href="#cb85-542" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-543"><a href="#cb85-543" aria-hidden="true" tabindex="-1"></a>green <span class="op">=</span> color_image[:,:,<span class="dv">1</span>]</span>
<span id="cb85-544"><a href="#cb85-544" aria-hidden="true" tabindex="-1"></a>red <span class="op">=</span> color_image[:,:,<span class="dv">0</span>]</span>
<span id="cb85-545"><a href="#cb85-545" aria-hidden="true" tabindex="-1"></a>plt.imshow( (green<span class="op">&gt;</span><span class="dv">120</span>) <span class="op">&amp;</span> (red<span class="op">&gt;</span><span class="dv">120</span>) , cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb85-546"><a href="#cb85-546" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-547"><a href="#cb85-547" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-550"><a href="#cb85-550" aria-hidden="true" tabindex="-1"></a><span class="in">```{python}</span></span>
<span id="cb85-551"><a href="#cb85-551" aria-hidden="true" tabindex="-1"></a>plt.imshow(np.logical_not(green<span class="op">&gt;</span><span class="dv">100</span>), cmap<span class="op">=</span><span class="st">'gray'</span>)</span>
<span id="cb85-552"><a href="#cb85-552" aria-hidden="true" tabindex="-1"></a><span class="in">```</span></span>
<span id="cb85-553"><a href="#cb85-553" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-554"><a href="#cb85-554" aria-hidden="true" tabindex="-1"></a><span class="fu">## Pair programming</span></span>
<span id="cb85-555"><a href="#cb85-555" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-556"><a href="#cb85-556" aria-hidden="true" tabindex="-1"></a>The following exercise will allow you explore multi-dimensional arrays by **working in pairs**. One person will write the code, while the other will explain what the code does. You can switch roles after each exercise.</span>
<span id="cb85-557"><a href="#cb85-557" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-558"><a href="#cb85-558" aria-hidden="true" tabindex="-1"></a>There are two parts so, you can switch roles after each part.</span>
<span id="cb85-559"><a href="#cb85-559" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb85-560"><a href="#cb85-560" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Part1</span><span class="co">](exercises_part1.qmd)</span></span>
<span id="cb85-561"><a href="#cb85-561" aria-hidden="true" tabindex="-1"></a><span class="ss">- </span><span class="co">[</span><span class="ot">Part2</span><span class="co">](exercises_part2.qmd)</span></span>
<span id="cb85-562"><a href="#cb85-562" aria-hidden="true" tabindex="-1"></a></span>
</code><button title="Copy to Clipboard" class="code-copy-button" data-in-quarto-modal=""><i class="bi"></i></button></pre></div>
</div></div></div></div></div>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>Â© 2024 Introduction to Coding and Data Analysis</p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>