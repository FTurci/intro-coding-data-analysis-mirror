{
  "hash": "f3a50cf0a68acceefca896db34450762",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Plotting with `matplotlib`\njupyter: python3\n---\n\n\n\nOne way to plot a graph in Python is to use the `matplotlib` package. \n\nMatplotlib is a powerful and widely-used Python library for creating static, animated, and interactive visualizations. It provides a flexible framework for generating a wide variety of plots and charts, making it a popular choice for data analysis and scientific research. With matplotlib, you can customize every aspect of your figures, from colors and styles to labels and legends.\n\n\nWe start by importing the `pyplot` sub-module from `matplotlib`.\n\nThe most widespread convention is to use the shorthand `plt` to refer to this package with the `as` syntax and so we can import this in the following way:\n\n::: {#39c41d0f .cell execution_count=2}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n```\n:::\n\n\n## Figure and Axes\n\nThere are two main interfaces for plotting using `matplotlib`.\n\n - The first is to use Pyplot (`plt`) to create a plot directly e.g. using `plt.plot()`. This is the type of syntax you may see often when looking online. This way of interacting with and plotting data was created to replicate the functionality of an alternative, and common programming language called MATLAB, which a lot of early Python adopters were familiar with.\n\n - The second, more modern way to create plots is to use the *object-oriented* approach where the figure is created first and then explicitly referenced when creating a plot. One way to do this is by calling the `subplots()` function to create a `Figure` (the canvas) and an `Axes` (the x-y axes) object which can then be used for plotting.\n\n```python\nfig, ax = plt.subplots()\n```\n\nWe can plot using the `ax` object directly using whichever type of graph we want to create e.g. \n - for a simple line graph we can use the [`plot()` function](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.plot.html)\n - for a scatter graph we can use the [`scatter()` function](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.scatter.html).\n - for a 1D histogram we can the [`hist()` function](https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.hist.html)\n \nYou can also add multiple graphs to the same set of Axes to plot sets of data on top of each other:\n\n::: {#2ea29ed8 .cell execution_count=3}\n``` {.python .cell-code}\nimport numpy as np\nfrom numpy import random\n\nrng = random.default_rng(seed=124)\n\nx = np.arange(1, 56, 5)\ny1 = x**2\ny2 = x**2 + rng.normal(size=len(x))*100 # Add random noise to our scatter points\n```\n:::\n\n\n::: {#e2c7401c .cell execution_count=4}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\nax.plot(x, y1)      # Plot line plot\nax.scatter(x, y2)   # Plot scatter plot as well\n```\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-4-output-1.png){}\n:::\n:::\n\n\nYou may notice that unlike other Python you have been writing, in Jupyter notebooks you should keep your plotting code together in one code cell as this will immediately be displayed when the code cell is run.\n\nTo create another plot in a new cell you can create new `Figure` and `Axes` objects using the same names `fig`, `ax` or name them something different if you'd prefer.\n\nMatplotlib sample plots - https://matplotlib.org/3.3.3/tutorials/introductory/sample_plots.html\n\n#### Aside: subplots\n\nYou may ask why the function for creating a new plot is called `subplots()`. By default, this function allows you to create one plot on one figure, which is usually what you want for an initial plot. However, it is possible to use the `subplots()` function to *create multiple plots on the same figure*. One way to do this is by specifying the number of rows (nrows) and number of columns (ncols) you want when using the `subplots()` function. Note that this will pass back an *array of Axes* objects rather than just one which you can then use to plot.\n\nWe won't explore this further, but for more details on how this is done have a look at the [subplots demo](https://matplotlib.org/stable/gallery/subplots_axes_and_figures/subplots_demo.html).\n\n---\n\n### Exercise A\n\nFor this exercise, we have created some random sample data which we can plot. Here we have created several numpy arrays each 100 elements long (based on `num_points`).\n\n::: {#c205818e .cell execution_count=5}\n``` {.python .cell-code}\nfrom numpy import random\n\nrng = random.default_rng(seed=68)\nnum_points = 100\n\nx_range = np.linspace(0.0, 1.0, num_points)\n\nrandom_sample1 = rng.normal(0.1, 0.5, size=num_points)\nrandom_sample2 = rng.random(num_points)\n```\n:::\n\n\n1. Create a scatter plot of `x_range` versus `random_sample1`.\n\n - *Start by creating your Figure and Axes objects (fig, ax) using the subplots function*\n - *Use the scatter method to plot your data using your Axes object*\n\n::: {#a7616dbf .cell execution_count=6}\n``` {.python .cell-code}\n### ADD CODE HERE\n```\n:::\n\n\n2. Create a line plot of `x_range` versus `random_sample2`\n\n - *As before, start by creating your Figure and Axes objects (fig, ax) using the subplots function*\n - *Use the plot method to plot your data using your Axes object*\n\n::: {#541b3e81 .cell execution_count=7}\n``` {.python .cell-code}\n### ADD CODE HERE\n```\n:::\n\n\n---\n\n## Annotating and adding features\n\nAs well as plotting you can, and should, add additional information to your plot as appropriate. For instance, you can:\n\n- change the style, colour etc. of your initial plot (e.g. see examples within [matplotlib decoration](fun_matplotlib_decoration.qmd))\n- add additional features such as axis labels, legend etc.\n\nThe code below demonstrates how we could customise the plot above using these inputs:\n\n### 1. Using more of the available plotting options\n\n::: {#806f524d .cell execution_count=8}\n``` {.python .cell-code}\nfig, ax = plt.subplots(figsize=(8, 4))\n\nax.plot(x, y1, color=\"slategrey\", linestyle=\"--\")\nax.scatter(x, y2, color=\"indianred\", marker='+', s=60)\n```\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-8-output-1.png){}\n:::\n:::\n\n\nWe can include more inputs for both our `subplots` function and our plotting functions such as `plot()` and `scatter()`:\n\n- For the `subplots()` initial step we specified the figure size, `figsize`, as an input. This is set using a tuple of (width, height) in inches.\n- For the [`plot` function](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.plot.html) we set:\n  - the colour to be a named colour called \"slategrey\" using the `color` input\n  - the style of the line to be dashed, using \"--\" and the `linestyle` input\n- For the [`scatter` function](https://matplotlib.org/3.3.3/api/_as_gen/matplotlib.axes.Axes.scatter.html) we set:\n  - the colour to be a named colour called \"indianred\" using the `color` input\n  - the marker shape to a cross shape, using \"+\" and the `marker` input\n  - size to be 60 (area of the marker) using the `s` input\n\nFor in-built options see:\n- Colours - https://matplotlib.org/stable/gallery/color/named_colors.html\n- Line style - https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html\n- Markers - https://matplotlib.org/api/markers_api.html\n\n### 2. Setting properties on the plot\n\n::: {#3488146d .cell execution_count=9}\n``` {.python .cell-code}\nfig, ax = plt.subplots(figsize=(8, 4))\n\nax.plot(x, y1, color=\"slategrey\", linestyle=\"--\")\nax.scatter(x, y2, color=\"indianred\", marker='+', s=60)\n\n### ADDED x and y labels and an x limit\nax.set_xlabel(\"x\")\nax.set_ylabel(\"y\")\nax.set_xlim(0, 52)\n```\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-9-output-1.png){}\n:::\n:::\n\n\nHere we set additional parameters for the plot - the x and y labels and an x limit. We have done this by calling the relevant functions (e.g. `set_xlabel`, `set_ylim`) on our `ax` variable.\n\nFor some examples of different `Axes` functions of this type see:\n- Axes - labels and limits - https://matplotlib.org/stable/api/axes_api.html#axis-labels-title-and-legend\n- Axes - tick labels - https://matplotlib.org/stable/api/axes_api.html#ticks-and-tick-labels\n\n### 3. Additional labelling - legend\n\n::: {#660435eb .cell execution_count=10}\n``` {.python .cell-code}\nfig, ax = plt.subplots(figsize=(8, 4))\n\n### Added labels for each of the plots\nax.plot(x, y1, color=\"slategrey\", linestyle=\"--\", label=\"Fitted line\")  # label input added when plotting\nax.scatter(x, y2, color=\"indianred\", marker='+', s=60, label=\"Measurements\")  # label input added when plotting\n\nax.set_xlabel(\"x\")\nax.set_ylabel(\"y\")\nax.set_xlim(0, 52)\n\n### Asked for a legend to be displayed\nax.legend()\n```\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-10-output-1.png){}\n:::\n:::\n\n\nA legend can be created using the `.legend()` function (method) and this will use the `label` value supplied when creating each plot. If `ax.legend()` is not included then, even if a `label` variable is specified, no legend will be added to the plot.\n\nSee:\n - legend function - https://matplotlib.org/stable/api/_as_gen/matplotlib.axes.Axes.legend.html\n\n## Other plot types\n\nWe can also apply similiar principles to other plot types. We can generate some more random data to look at this. Here we have created two normal distributions containing different numbers of points.\n\n::: {#38e51166 .cell execution_count=11}\n``` {.python .cell-code}\n# Create random numbers (normal distribution) to plot\nfrom numpy import random\n\nrng = random.default_rng(seed=68)\nnumber_of_points_1 = 5000\nnumber_of_points_2 = 500\n\nx_rand1 = rng.normal(size=number_of_points_1)\nx_rand2 = rng.normal(size=number_of_points_2)\n```\n:::\n\n\nWe could create a simple plot using the `subplots` function and the [`hist()` function](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html):\n\n::: {#e5531fdc .cell execution_count=12}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\n\nax.hist(x_rand1)\nax.hist(x_rand2)\n```\n\n::: {.cell-output .cell-output-display execution_count=11}\n```\n(array([ 10.,  30.,  66., 103.,  93.,  93.,  55.,  40.,   7.,   3.]),\n array([-2.48175617, -1.9278922 , -1.37402822, -0.82016424, -0.26630026,\n         0.28756372,  0.8414277 ,  1.39529168,  1.94915565,  2.50301963,\n         3.05688361]),\n <BarContainer object of 10 artists>)\n```\n:::\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-12-output-2.png){}\n:::\n:::\n\n\nUsing the exact same data we could update our plot using relevant inputs for our `hist` function and setting values on our axis:\n\n::: {#3a065887 .cell execution_count=13}\n``` {.python .cell-code}\nfig, ax = plt.subplots()\n\n# Create an explicit range to use for our histogram bins\nbins = np.arange(-3, 3, 0.2)\n\n# Include colour, transparency (alpha), plot type (density) inputs as well as a label\nax.hist(x_rand1, color=\"skyblue\", alpha=0.7, bins=bins, density=True, label=\"Sample 1\")\nax.hist(x_rand2, color=\"tan\", alpha=0.7, bins=bins, density=True, label=\"Sample 2\")\n\n# Update plotting area to label and set axes limits\nax.set_xlabel(\"y\")\nax.set_ylabel(\"Number in x\")\nax.set_xlim(-3, 3)\nax.set_ylim(0, 0.5)\n\n# Add legend to the plot (uses labels defined above)\nax.legend()\n```\n\n::: {.cell-output .cell-output-display}\n![](lecture_intro_matplotlib_files/figure-html/cell-13-output-1.png){}\n:::\n:::\n\n\nFor our histogram, in addition to options we used for our scatter and line plot, we have set more options available to us:\n - `alpha` - This allows us to make our data partially transparent to better view overlapping data\n - `bins` - We defined and included an input for the bin sizes rather than using the default\n - `density` - This is a plot type we can set which normalised our data for the different datasets. This can be useful if you are comparing datasets which have different sample sizes.\n\nIn general, you will need to look at the specific documentation for each of the the plot types to see what options are available.\n\n## Anatomy of a figure\n\nThis is a [summary image](https://matplotlib.org/examples/showcase/anatomy.html) to show the make up (anatomy) of a plot in matplotlib.\n\n<img src=\"images/Anatomy_plot_matplotlib.png\" alt=\"Matplotlib Plot\" style=\"display:block;margin-left:auto;margin-right:auto;width:40%\"/>\n\nYou can see some features we have described above such as \"Figure\", \"Axes\", \"x axis label\", \"y axis label\", \"legend\". But you can also see how our inputs have influenced other aspects of the plot e.g. \"Major tick\", \"Minor tick\", \"Major tick label\", \"Minor tick label\", which were updated when we set the limits on the x and y axes, and \"Markers\" from our scatter plot which updated the marker style and colour.\n\nBecoming familiar with this terminology when applied to a matplotlib figure allows you to put a name to any part of the plot you wish to modify and to dig into the features offered for how to update these plots. \n\n---\n\n### Exercise B\n\n1. Create a scatter plot with the same data from Exercise A showing `x_range` versus `random_sample1` adding or setting the following features:\n - changing the [marker](https://matplotlib.org/api/markers_api.html) and [colour](https://matplotlib.org/stable/gallery/color/named_colors.html)\n - setting appropriate x and y labels\n \n*Remember, you always need to recreate your fig and ax objects using the subplots function to create a new plot using Jupyter notebooks*\n\n::: {#fb6b8f51 .cell execution_count=14}\n``` {.python .cell-code}\n### ADD CODE HERE (copy code from Exercise A1 to start)\n```\n:::\n\n\n2. Create a histogram plot overlaying data from `random_sample1` and `random_sample2`. \n\n - Experiment with different inputs to see if you can improve the default plot (e.g. setting the bin size, including transparency, changing the colours etc.)\n - *You can also look at the [`hist()` function documentation](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.hist.html) for more inputs to try e.g. `histtype`.*\n\n::: {#f52f9f56 .cell execution_count=15}\n``` {.python .cell-code}\n### ADD CODE HERE\n```\n:::\n\n\n**Extra.** Create a plot containing both a scatter plot for `x_range` versus `random_sample1` AND a line plot for `x_range` versus `random_sample2`. Add or set the following features:\n - changing the [line style](https://matplotlib.org/stable/gallery/lines_bars_and_markers/linestyles.html) and colour\n - setting a title for your plot\n\n*Hint: Look at \"set_\" commands within https://matplotlib.org/stable/api/axes_api.html#axis-labels-title-and-legend*\n\n::: {#41b0cde8 .cell execution_count=16}\n``` {.python .cell-code}\n### ADD CODE HERE\n```\n:::\n\n\n---\n\n*Extended: Pick an interesting plot from the [matplotlib gallery](https://matplotlib.org/gallery/index.html) and see if you replicate some of the additional features for these plots.*\n\n---\n\nYou can now proceed with the remaining exercises\n\n- [Exercise C](exercises_plotting_data_from_file.qmd) - Plotting data from a file\n- [A fun session](fun_matplotlib_decoration.qmd) - Using matplotlib to create a fun plot\n\n",
    "supporting": [
      "lecture_intro_matplotlib_files"
    ],
    "filters": [],
    "includes": {}
  }
}