{
  "hash": "821cb77ce5271d453062461cc3e38724",
  "result": {
    "engine": "jupyter",
    "markdown": "---\ntitle: Hint 1 - creating a square mask\njupyter: python3\n---\n\n\n\n**Example: Creating a 100 x 100 grid containing a square where the centre of that square is at (80, 40) and the width is 30.**\n\nTo check whether an (x, y) position is within the square we want to define, we want to evaluate if these two conditions are both satisfied:\n$$|x - x_0| = w/2$$\nand\n$$|y - y_0| = w/2$$\n\nwhere\n - $x$, $y$ are the x, y positions within the grid\n - $x_0$, $y_0$ are the centre of the square\n - $w$ - is both the full width and height of the square\n - $| |$ means the magnitude of the difference\n\nThis code will show one way to create a mask which contains a square. This will take the most direct approach and evaluate every index in the 2D array one at a time.\n\n::: {#7e44424f .cell execution_count=1}\n``` {.python .cell-code}\nimport numpy as np\n\nshape = (100, 100)\n```\n:::\n\n\nStart by creating an array of zeros for our overall grid:\n\n::: {#26012787 .cell execution_count=2}\n``` {.python .cell-code}\nsquare_mask = np.zeros(shape)\nprint(square_mask)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\n[[0. 0. 0. ... 0. 0. 0.]\n [0. 0. 0. ... 0. 0. 0.]\n [0. 0. 0. ... 0. 0. 0.]\n ...\n [0. 0. 0. ... 0. 0. 0.]\n [0. 0. 0. ... 0. 0. 0.]\n [0. 0. 0. ... 0. 0. 0.]]\n```\n:::\n:::\n\n\nNext we can define the parameters we need for the square:\n\n::: {#322fdf20 .cell execution_count=3}\n``` {.python .cell-code}\ncentre = (80, 40) # Centre (x, y)\nwidth = 30 # Width of square\n```\n:::\n\n\nSo, to check whether a given position is within our mask (the square we are defining), we need to find a way to use our equations above and write them in code.\n\nWe've created a grid of size of 100 x 100 so, as an example, let's use the position (50, 50) for our grid:\n\n::: {#86571bae .cell execution_count=4}\n``` {.python .cell-code}\nx = 50\ny = 50\n\nx0 = centre[0] # Define central x position for the square\ny0 = centre[1] # Define central y position for the square\n\n# Edge of square\n# |x - x0| = width/2\n# |y - y0| = width/2\n\ndistance_x = np.abs(x - x0) # Magnitude of distance - x-x0\ndistance_y = np.abs(y - y0) # Magnitude of distance - y-y0\n\n# Use our conditions to check whether this (y, x) position is inside the square\nif distance_x < width/2 and distance_y < width/2:\n    print(\"Position is inside the mask\")\n    square_mask[y, x] = 1 # Using our index values, set to value within our array to 1 if this is inside the square\nelse:\n    print(\"Position is not inside the mask\")\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nPosition is not inside the mask\n```\n:::\n:::\n\n\nNow we can build this up to look at every element in the 2D array we have created and check whether this is inside the square (we will leave the value as 0) or outside the square (we will set the value to 1). To do this we can loop through every column and every row and check the result of our conditions:\n\n::: {#8333a552 .cell execution_count=5}\n``` {.python .cell-code}\nx0 = centre[0]\ny0 = centre[1]\n\nncol = shape[0]\nnrow = shape[1]\n\nfor y in range(nrow): # iterate over first dimension\n    for x in range(ncol): # iterate over second dimension\n        \n        distance_x = np.abs(x - x0) # Magnitude of distance\n        distance_y = np.abs(y - y0) # Magnitude of distance\n        \n        # Check whether each position is inside the square\n        if distance_x < width/2 and distance_y < width/2:\n            square_mask[y, x] = 1 # Set to 1 if inside the square\n```\n:::\n\n\nWe don't need an `else` block here because the array we have defined *already contains zeros*. This means if our conditin doesn't match we don't need to update the values within the array.\n\nWe could check where our mask has been set to 1 using the `np.where` function. For a two-dimensional array like `square_mask`, this will return two arrays containing the positions of the match - one for the first dimension and one for the second dimension.\n\nEach pair of values (one in the first array and one the second) represents a 2D position in our array:\n\n::: {#94bc1f11 .cell execution_count=6}\n``` {.python .cell-code}\n# Where have we created our mask in our overall grid\nnp.where(square_mask == 1)\n```\n\n::: {.cell-output .cell-output-display execution_count=6}\n```\n(array([26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26,\n        26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 26, 27, 27, 27, 27, 27,\n        27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27, 27,\n        27, 27, 27, 27, 27, 27, 27, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,\n        28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28, 28,\n        28, 28, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29,\n        29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 29, 30, 30, 30,\n        30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30, 30,\n        30, 30, 30, 30, 30, 30, 30, 30, 30, 31, 31, 31, 31, 31, 31, 31, 31,\n        31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31, 31,\n        31, 31, 31, 31, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32,\n        32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 33,\n        33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33,\n        33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34,\n        34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34,\n        34, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35,\n        35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35, 35,\n        35, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36,\n        36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 36, 37, 37, 37, 37,\n        37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37, 37,\n        37, 37, 37, 37, 37, 37, 37, 37, 38, 38, 38, 38, 38, 38, 38, 38, 38,\n        38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38,\n        38, 38, 38, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39,\n        39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 39, 40, 40,\n        40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 40,\n        40, 40, 40, 40, 40, 40, 40, 40, 40, 40, 41, 41, 41, 41, 41, 41, 41,\n        41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41, 41,\n        41, 41, 41, 41, 41, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42,\n        42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42, 42,\n        43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43,\n        43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 43, 44, 44, 44, 44, 44,\n        44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44, 44,\n        44, 44, 44, 44, 44, 44, 44, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45,\n        45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45, 45,\n        45, 45, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46,\n        46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 46, 47, 47, 47,\n        47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47, 47,\n        47, 47, 47, 47, 47, 47, 47, 47, 47, 48, 48, 48, 48, 48, 48, 48, 48,\n        48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48, 48,\n        48, 48, 48, 48, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49,\n        49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 49, 50,\n        50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50,\n        50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 50, 51, 51, 51, 51, 51, 51,\n        51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51, 51,\n        51, 51, 51, 51, 51, 51, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52,\n        52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52, 52,\n        52, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53,\n        53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 53, 54, 54, 54, 54,\n        54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54, 54,\n        54, 54, 54, 54, 54, 54, 54, 54]),\n array([66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82,\n        83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70,\n        71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87,\n        88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75,\n        76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92,\n        93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n        81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68,\n        69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,\n        86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73,\n        74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90,\n        91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78,\n        79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66,\n        67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,\n        84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71,\n        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88,\n        89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,\n        77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,\n        94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81,\n        82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69,\n        70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,\n        87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74,\n        75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91,\n        92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79,\n        80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67,\n        68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84,\n        85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72,\n        73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89,\n        90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77,\n        78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94,\n        66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82,\n        83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70,\n        71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87,\n        88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75,\n        76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92,\n        93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80,\n        81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68,\n        69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85,\n        86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73,\n        74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90,\n        91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78,\n        79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66,\n        67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83,\n        84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71,\n        72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88,\n        89, 90, 91, 92, 93, 94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76,\n        77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93,\n        94, 66, 67, 68, 69, 70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81,\n        82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 92, 93, 94, 66, 67, 68, 69,\n        70, 71, 72, 73, 74, 75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86,\n        87, 88, 89, 90, 91, 92, 93, 94]))\n```\n:::\n:::\n\n\nWe can look at this mask using `matplotlib` and a plotting option called `imshow` ([documentation](https://matplotlib.org/stable/api/_as_gen/matplotlib.pyplot.imshow.html); [example from image gallery](https://matplotlib.org/stable/gallery/images_contours_and_fields/image_demo.html)):\n\n::: {#c2ff5a93 .cell execution_count=7}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots(figsize=(6, 3.2))\n\nax.set_title('Square Mask')\nax.imshow(square_mask,cmap=\"bone\",origin=\"lower\")\n```\n\n::: {.cell-output .cell-output-display}\n![](hint1_mask_files/figure-html/cell-8-output-1.png){}\n:::\n:::\n\n\nIn this plot, the white represents the values in the mask (values of 1) and the black represents the values outside the mask (values of 0).\n\n---\n\n### Extended: Leveraging numpy functionality\n\nAn alternative and more efficient way to do this would be to leverage the properties of numpy arrays and the available numpy functions and indexing.\n\nWe can start in the same way and create our array of zeros of the right shape\n\n::: {#9b204622 .cell execution_count=8}\n``` {.python .cell-code}\nsquare_mask_2 = np.zeros(shape)\n```\n:::\n\n\nWe can represent the pixel position for our x and y dimensions using numbers for 0 to 99 (for x) and 0 to 99 (for y) since our shape is 100 x 100. \n\nWe can then create a pair of 2D grids, `X` and `Y`, to match to the shape of our mask using a [function called `np.meshgrid()`](https://numpy.org/doc/stable/reference/generated/numpy.meshgrid.html). This stretches our x and y coordinate values to create our 2D numpy arrays.\n\n::: {#16f2d2e7 .cell execution_count=9}\n``` {.python .cell-code}\n# Create arrays matching to our size along our x and y axes\nx = np.arange(shape[1])\ny = np.arange(shape[0])\n\nX, Y = np.meshgrid(x, y)\n\nprint(f\"X array: {X.shape}\")\nprint(X)\nprint(f\"Y array: {Y.shape}\")\nprint(Y)\n```\n\n::: {.cell-output .cell-output-stdout}\n```\nX array: (100, 100)\n[[ 0  1  2 ... 97 98 99]\n [ 0  1  2 ... 97 98 99]\n [ 0  1  2 ... 97 98 99]\n ...\n [ 0  1  2 ... 97 98 99]\n [ 0  1  2 ... 97 98 99]\n [ 0  1  2 ... 97 98 99]]\nY array: (100, 100)\n[[ 0  0  0 ...  0  0  0]\n [ 1  1  1 ...  1  1  1]\n [ 2  2  2 ...  2  2  2]\n ...\n [97 97 97 ... 97 97 97]\n [98 98 98 ... 98 98 98]\n [99 99 99 ... 99 99 99]]\n```\n:::\n:::\n\n\nWe can find the positions where our conditions are met within our grid using the [`np.where()` function](https://numpy.org/doc/stable/reference/generated/numpy.where.html). From here we can filter our mask using [integer array indexing](https://numpy.org/doc/stable/user/basics.indexing.html#integer-array-indexing) and change these values from 0 to 1 within our mask.\n\n::: {#a89ded2a .cell execution_count=10}\n``` {.python .cell-code}\n# We can calculate the x and y distances for each value in our 2D grids\ndistance_x = np.abs(X - x0) # Magnitude of distance\ndistance_y = np.abs(Y - y0) # Magnitude of distance\n\n# We can use the numpy where function to find the positions where our conditions are matched\n# - to include multiple conditions we have included an & (known as a bitwise operator)\nindices = np.where((distance_x < width/2) & (distance_y < width/2))\n\n# And using these indices change the values to 1\nsquare_mask_2[indices] = 1\n```\n:::\n\n\n::: {#b8f3f6d1 .cell execution_count=11}\n``` {.python .cell-code}\nimport matplotlib.pyplot as plt\n\nfig, ax = plt.subplots(figsize=(6, 3.2))\n\nax.set_title('Square Mask (alternative method)')\nax.imshow(square_mask_2,cmap=\"bone\",origin=\"lower\")\n```\n\n::: {.cell-output .cell-output-display}\n![](hint1_mask_files/figure-html/cell-12-output-1.png){}\n:::\n:::\n\n\n---\n\n",
    "supporting": [
      "hint1_mask_files"
    ],
    "filters": [],
    "includes": {}
  }
}